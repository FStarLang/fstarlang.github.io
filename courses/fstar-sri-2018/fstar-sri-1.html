<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 1.1.4" />
  <meta name="author" content="Nikhil Swamy and Jonathan Protzenko" />
  <title>Programming and Proving in F* and Low*</title>
  <style type="text/css"  class="link">
  /*# sourceURL=madoko.css */
  
  .madoko .toc>.tocblock .tocblock .tocblock {
    margin-left: 2.25em;
  }
  .madoko .toc>.tocblock .tocblock {
    margin-left: 1.5em;
  }
  .madoko .toc-contents>.tocblock>.tocitem {
    font-weight: bold;
  }
  .madoko .toc {
    margin-top: 1em;
  }
  .madoko p.para-continue {
    margin-bottom: 0pt;
  }
  .madoko .para-block+p {
    margin-top: 0pt;
  }
  .madoko ul.para-block, .madoko ol.para-block {
    margin-top: 0pt;
    margin-bottom: 0pt;
  }
  .madoko ul.para-end, .madoko ol.para-end {
    margin-bottom: 1em;
  }
  .madoko dl {
    margin-left: 0em;
  }
  .madoko blockquote {
    font-style: italic;
  }
  .madoko a.localref {
    text-decoration: none;
  }
  .madoko a.localref:hover {
    text-decoration: underline;
  }
  .madoko .footnotes {
    font-size: smaller;
    margin-top: 2em;
  }
  .madoko .footnotes hr {
    width: 50%;
    text-align: left;
  }
  .madoko .footnote { 
    margin-left: 1em;
  }
  .madoko .footnote-before {
    margin-left: -1em;
    width: 1em;
    display: inline-block;
  }
  .madoko .align-center, .madoko .align-center>p {
    text-align: center !important;
  }
  .madoko .align-center pre {
    text-align: left;
  }
  .madoko .align-center>* {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .madoko .align-left, .madoko .align-left>p {
    text-align: left !important;
  }
  .madoko .align-left>* {
    margin-left: 0pt !important;
    margin-right: auto !important;
  }
  .madoko .align-right, .madoko .align-right>p {
    text-align: right !important;
  }
  .madoko .align-right>* {
    margin-left: auto !important;
    margin-right: 0pt !important;
  }
  .madoko .align-center>table,
  .madoko .align-left>table,
  .madoko .align-right>table {
    text-align: left !important;
  }
  .madoko .equation-before {
    float: right;
  }
  .madoko .bibitem {
    font-size: smaller;
  }
  .madoko .bibsearch {
    font-size: x-small;
    text-decoration:none;
    color: black;
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  .madoko .block, .madoko .figure, .madoko .bibitem, .madoko .equation, .madoko div.math {
    margin-top: 1ex;
    margin-bottom: 1ex;
  }
  .madoko .figure {
    padding: 0.5em;
    margin-left: 0pt;
    margin-right: 0pt;
  }
  .madoko .hidden {
    display: none;
  }
  .madoko .invisible {
    visibility: hidden;
  }
  .madoko.preview .invisible {
    visibility: visible;
    opacity: 0.5;
  }
  .madoko code.code, .madoko span.code {
    white-space: pre-wrap;
  }
  .madoko hr, hr.madoko {
    border: none;
    border-bottom: black solid 1px;
    margin-bottom: 0.5ex;
  }
  .madoko .framed>*:first-child {
    margin-top: 0pt;
  }
  .madoko .framed>*:last-child {
    margin-bottom: 0pt;
  }
  .madoko ul.list-style-type-dash {
      list-style-type: none !important;
  }
  .madoko ul.list-style-type-dash > li:before {
      content: "\2013"; 
      position: absolute;
      margin-left: -1em; 
  }
  .madoko table.madoko {
    border-collapse: collapse;
  }
  .madoko td, .madoko th {
    padding: 0ex 0.5ex;
    margin: 0pt;
    vertical-align: top;
  }
  .madoko .cell-border-left {
    border-left: 1px solid black;
  }
  .madoko .cell-border-right {
    border-right: 1px solid black;
  }
  .madoko thead>tr:first-child>.cell-line,
  .madoko tbody:first-child>tr:first-child>.cell-line {
    border-top: 1px solid black;
    border-bottom: none;
  }
  .madoko .cell-line, .madoko .cell-double-line {
    border-bottom: 1px solid black;
    border-top: none;
  }
  .madoko .cell-double-line {
    border-top: 1px solid black;
    padding-top: 1.5px !important;
  }
  .madoko .input-mathpre .MathJax_Display {
    text-align: left !important;
  }
  .madoko div.input-mathpre {
    text-align: left;
    margin-top: 1.5ex;
    margin-bottom: 1ex;
  }
  .madoko .math-rendering {
    text-align: left;
    white-space: pre;
    color: gray;
  }
  .madoko .mathdisplay {
    text-align: center;
  }
  .madoko .pretty table {
    border-collapse: collapse;
  }
  .madoko .pretty td {
    padding: 0em;
  }
  .madoko .pretty td.empty {
    min-width: 1.5ex;
  }
  .madoko .pretty td.expander {
    width: 100em;
  }
  body.madoko, .madoko .serif {
    font-family: Cambria,"Times New Roman","Liberation Serif","Times",serif;
  }
  .madoko .sans-serif {
    font-family: "Calibri", "Optima", sans-serif;
  }
  .madoko .symbol {
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  body.madoko {  
    -webkit-text-size-adjust: 100%;       
    text-rendering: optimizeLegibility;
  }
  body.madoko {
    max-width: 88ex; 
    margin: 1em auto;
    padding: 0em 2em;  
  }
  body.preview.madoko {
    padding: 0em 1em;
  }
  .madoko p {
    text-align: justify;
  }
  .madoko h1, .madoko h2, .madoko h3, .madoko h4 { 
    margin-top: 1.22em; 
    margin-bottom: 1ex;
  }
  .madoko h1+p, .madoko h2+p, .madoko h3+p, .madoko h4+p, .madoko h5+p  { 
    margin-top: 1ex;    
  }
  .madoko h5, .madoko h6 { 
    margin-top: 1ex;
    font-size: 1em;
  }
  .madoko h5 { 
    margin-bottom: 0.5ex;
  }
  .madoko h5 + p {
    margin-top: 0.5ex;
  }
  .madoko h6 { 
    margin-bottom: 0pt;
  }
  .madoko h6 + p {
    margin-top: 0pt;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt, 
  .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-family: Consolas,"Andale Mono WT","Andale Mono",Lucida Console,Monaco,monospace,monospace;
    font-size: 0.85em;
  }
  .madoko pre code, .madoko .token-indent {
    font-size: 0.95em;
  }
  .madoko pre code {
    font-family: inherit !important;
  }
  .madoko ol.linenums li {
    background-color: white;
    list-style-type: decimal;
  }
  .madoko .remote {
    background-color: #F0FFF0;
  }
  .madoko .remote + * {
    margin-top: 0pt;
  }
  @media print {
    body.madoko {
      font-size: 10pt;
    }
    @page {
      margin: 1in 1.5in;
    }
  }
  @media only screen and (max-device-width:1024px) {
    body.madoko {
      padding: 0em 0.5em;    
    }
    .madoko li {
      text-align: left;
    }
  }
  
    </style>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/reveal.js/2.6.2/css/reveal.min.css"  class="link">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/reveal.js/2.6.2/css/theme/solarized.css"  class="link">
  <script src="https://cdn.jsdelivr.net/reveal.js/2.6.2/lib/js/head.min.js"  class="script preview"></script>
  <script src="https://cdn.jsdelivr.net/reveal.js/2.6.2/js/reveal.js"  class="script preview"></script>
  <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/reveal.js/2.6.2/css/theme/solarized.css" id="theme">    
      <!--[if lt IE 9]>
      <script src="https://cdn.jsdelivr.net/reveal.js/2.6.2/lib/js/html5shiv.js"></script>
      <![endif]-->
      <style>
      body.madoko {
        margin: 0pt;
        padding: 0pt;
        max-width: 100%;      
      }
      .madoko .reveal h1 {
          font-size: 3.7em;
      }
      .madoko .reveal h2 {
          font-size: 2.1em;
      }
      .reveal .authorblock .author {
          font-size: 120%;
          margin-bottom: 1ex;
      }        
      .reveal table {
          margin-left: auto;
          margin-right: auto;
      }
      .reveal pre table {
        margin-left: 0pt;
      }
      .madoko .reveal pre.pretty {
        padding-top: 0pt;
        padding-bottom: 0pt;
      }
      .reveal li p {
          text-align: left;
      }
      .reveal h2 {
          margin-bottom: 0.7em;
      }
      .reveal section ul,
      .reveal section ol {
          margin-top: 0.35em;
          margin-bottom: 0.35em;
      }
      .reveal section img.math-display {
          padding: 1em;
          box-shadow: none;
          border: none;
      }
      .reveal section img.math-inline {
          margin: 0pt;
          padding: 0pt;
          background-color: none;
          box-shadow: none;
          border: none;
      }
      .reveal section img {
          box-shadow: none;
          border: none;
      }
      .madoko .reveal pre {
          border: 1px solid black;
          word-wrap: normal;
          background-color: white;
          font-size: 0.7em;
          padding: 0.7em;
          line-height: 100%;
          width: 100%;
      }      
      .reveal pre code, .reveal code {
          padding: 0pt;
      }
      .reveal nav.toc {
          line-height: 1em;
          font-size: 60%;
          overflow-y: auto;
      }    
      .reveal .tocitem {
          text-align: left;
      }
      .reveal .toc>.tocblock .tocblock {
          margin-left: 0.5em;
      }   
      .reveal .toc>.tocblock .tocblock .tocblock {
          margin-left: 1em;
      }
      .reveal .bibliography {
        height: 18em;
        overflow-y: auto;
        font-size: 0.8em;
        line-height: 1.25;
      }
      .reveal section[data-smaller=""],
      .reveal section[data-smaller="true"] {
        font-size: 80%;
        width: 110%;
      }
      .reveal .slides>section[data-smaller=""],
      .reveal .slides>section[data-smaller="true"] {
        left: -55%;
      }
      .reveal .details {
        display: none;
      }
      .reveal[data-details=""] .details,
      .reveal[data-details="true"] .details {
        display: initial;
      }
      /* Display in the preview window */
      html, body.madoko.preview, body.madoko.preview-full, .body.madoko {
        height  : 100% !important;
        width   : auto!important;
        padding : 0pt !important;
        margin  : 0pt !important;
      }
      body.madoko.preview, body.madoko.preview-full, .preview .body.madoko {
        overflow: hidden !important;
      }
      body.preview .reveal .slides .fragment {
        visibility: visible;
        opacity: 0.5;
      }
      body.preview .reveal .slides .fragment.visible {
        opacity: 1.0;
      }
      .preview .reveal div.notes,
      .preview .reveal aside.notes {
        display  : block;
        position : absolute;
        width    : 30%;
        left     : 70%;
        top      : -15%;
        font-size: 50%;
        border   : 1px solid black;
        border-radius   : 10px;
        background-color: white;
      }
      /* 'static' display in the preview window, unused for now */
      body.preview.static div.reveal, 
      body.preview.static div.ticreveal .slides, 
      body.preview.static div.reveal section {
        display: block !important;
        position: relative !important;
        width: auto !important;      
      }
      body.preview.static div.reveal section {
        border: solid 1px black;
        padding: 1em !important;
        margin-top: 1em;
        min-height: 15em;
        top: 0pt;
      }
      body.madoko.preview.static section {
        font-size: 75%;
      }
      body.madoko.preview.static {
        padding: 0em 1em !important;
      }
      body.madoko.preview.static .reveal pre {
        width: 95%;
      }    
      body.preview .reveal[data-details="false"] .details {
        display: initial;
        color: gray;
      }
      body.preview .reveal[data-long="false"] section[data-long] {
        border-left: 2px black solid;
      }
      </style>
      <script>    
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      window.revealConfig = {
          controls: true,
          progress: true,
          history: true,
          center: /^\s*(true|1)\s*$/i.test("true"),
          slideNumber: /^\s*(true|1)\s*$/i.test("true"),
          dependencies: [
            { src: 'https://cdn.jsdelivr.net/reveal.js/2.6.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'https://cdn.jsdelivr.net/reveal.js/2.6.2/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
            { src: 'https://cdn.jsdelivr.net/reveal.js/2.6.2/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
          ],
      };
      function revealAddFragments() {
        [].forEach.call(document.querySelectorAll( ".fragmented" ), function(elem0) {
          var elem = (/^H\d$/.test(elem0.nodeName) ? elem0.parentNode : elem0);
          [].forEach.call(elem.children, function(item) {
            if (item==elem0) return;
            if (item && !/\bfragment(ed)?\b/.test(item.className) && item.nodeType===1) {
              item.className = item.className + " fragment";
            }
          });
        });
      }
      function revealQuotedList(listType) {
        //compatibility with Rmarkdown slides
        [].forEach.call( document.querySelectorAll("blockquote>" + listType), function(ul) {
          if (!/\bfragmented\b/.test(ul.className)) {
            ul.className = ul.className + " fragmented";
          }        
          var quote = ul.parentNode;
          if (quote.childElementCount===1) {
            quote.parentNode.replaceChild(ul,quote);
          }
        });
      }
      function revealBuildToFragmented() {
        [].forEach.call(document.querySelectorAll( ".build" ), function(elem) {
          if (elem && !/\bfragmented\b/.test(elem.className) && elem.nodeType===1) {
            elem.className = elem.className + " fragmented";
          }
        });
      }
      function revealDivNotesToAside() {
        [].forEach.call(document.querySelectorAll("div.notes"), function(elem) {
          var aside = document.createElement("ASIDE");
          if (elem.id) aside.id = elem.id;
          aside.className = elem.className;
          [].forEach.call(elem.attributes, function(attr) {
            aside.setAttribute( attr.name, attr.value );
          });
          aside.innerHTML = elem.innerHTML;
          elem.parentNode.replaceChild(aside,elem);
        });
      }
      function revealDataQuery() {
        var reveal = document.querySelector(".reveal");
        if (!reveal) return;
        window.location.search.replace(/\bdata-(\w+)(?:=(\w+))?\b/g, function(matched,key,value) {
          reveal.setAttribute("data-" + key, (value ? value : ""));
          return matched;
        });
      }
      function revealRemoveLong() {
        // remove parts for 'long' presentation
        if (/\bpreview(?![\w\-])/.test(document.body.className)) return;
        var reveal = document.querySelector(".reveal");
        if (!reveal) return;
        var value = reveal.hasAttribute("data-long") ? reveal.getAttribute("data-long") : null;
        if (value==null || value=="false" || value=="0") {
          [].forEach.call( document.querySelectorAll("section[data-long]"), function(elem) {
            elem.parentNode.removeChild(elem);
          });
        }
      }
      revealConfig.onLoad = function() {
        revealConfig.getEmbeddedImages();
        revealDataQuery();
        revealRemoveLong();
        revealQuotedList("ul");
        revealQuotedList("ol");
        revealBuildToFragmented();
        revealDivNotesToAside();
        revealAddFragments();
      };
      document.addEventListener("load",revealConfig.onLoad);    
      document.addEventListener("DOMContentLoaded", function() {
        if (typeof Reveal !== "undefined" && !Reveal.isReady()) {
          revealConfig.onLoad();
          Reveal.initialize(revealConfig);
        }
      });    
      // add support for printing:
      // use  ?print-pdf to get a pdf-printable version (in Chrome)
      // use  ?print-paper to get a paper-printable version.
      revealConfig.initPrint = function() {
        var cssLink = null;
        var bodyClass = null;
        var cap = window.location.search.match(/\bprint-(\w+)\b/);
        if (cap) {
          bodyClass = cap[0];
          cssLink = "https://cdn.jsdelivr.net/reveal.js/2.6.2/css/print/" + cap[1] + ".css";
        }
        if (cssLink) {
          var link  = document.createElement( "link" );
          link.rel  = "stylesheet";
          link.type = "text/css";
          link.href = cssLink;
          var head = document.getElementsByTagName( 'head' )[0];
          if (head) head.appendChild( link );
        }
        if (bodyClass) {
          document.body.className = document.body.className + " " + bodyClass;
        }
      };
      revealConfig.getEmbeddedImages = function() {
        var images = {};
        [].forEach.call( document.querySelectorAll("img[data-linkid]"), function(img) {
          var linkid = img.getAttribute("data-linkid");
          if (linkid) images["/" + linkid] = img.src;
          var path = img.getAttribute("data-path");
          if (path) images["/" + path] = img.src;
        });     
        [].forEach.call( document.querySelectorAll("section"), function(slide) {
          var attrName = "data-background";
          var image = slide.getAttribute(attrName);
          if (!image) {
            attrName = "data-background-image";
            image = slide.getAttribute(attrName);
          }
          if (!image) return;
          var cap = /^\s*!?\[([^\]]+)\]\s*$/.exec(image);
          var href = images["/" + (cap ? cap[1] : image)];
          if (!href) return;
          if (attrName==="data-background" && /^data:/.test(href)) href = "url(" + href + ")";
          slide.setAttribute(attrName, href);
        });
      };    
      </script>
  <script src="aux/script.js"></script>
      <link rel="stylesheet" href="aux/style.css" id="custom_style">
  </head>
<body class="madoko">

<div class="body madoko" style="line-adjust:0">
<div class="reveal" data-long="false" data-details="false" data-line="15" style="line-adjust:0">
<div class="slides" data-line="15" style="line-adjust:0">

<div class="mathdefs input-mathdefs" data-line="16"></div>
<section id="sec-programming-and-proving-in-f--and-low-" class="section section1" data-section-depth="1" data-line="20"><h2 id="heading-sec-programming-and-proving-in-f--and-low-" class="h1" data-heading-depth="1" style="display:block">Programming and Proving in F* and Low*</h2>
<div class="center align-center" data-line="22" style="text-align:center">
<p class="p noindent" data-line="23"><span data-line="23"></span><a href="https://www.fstar-lang.org"><img src="aux/fstar-new.png" alt="fstar-logo" data-path="aux/fstar-new.png" data-linkid="fstar-logo" style="width:200px"></a><span data-line="23"></span>
</p>
<p class="p indent" data-line="25"><span data-line="25"></span><strong class="strong-star2"><a href="http://research.microsoft.com/~nswamy/">Nik Swamy</a></strong><span data-line="25"></span>
and
<span data-line="27"></span><strong class="strong-star2"><a href="http://research.microsoft.com/~protz/">Jonathan Protzenko</a></strong><span data-line="27"></span>
</p>
<p class="p indent" data-line="29"><span data-line="29"></span><a href="http://fm.csl.sri.com/SSFT18/">SRI Summer School on Formal Techniques (2018)</a><span data-line="29"></span>
</p></div><!-------------------------------------------------------------------------------->


</section>
<section id="sec-program-verification--shall-the-twain-ever-meet" class="section section2" data-section-depth="2" data-line="37"><h3 id="heading-sec-program-verification--shall-the-twain-ever-meet" class="h2" data-heading-depth="2" style="display:block">Program verification: Shall the twain ever meet?</h3><!-- Two, mostly disjoint sides of program verification research -->


<table class="madoko block" data-line="41">
<thead><tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-line="41" data-row="1" colspan="2" data-col="1" style="font-weight:bold;text-align:center"><span data-line="41"></span> <span style="color:DarkRed">Interactive proof assistants</span><span data-line="41"></span> </th><th class="col cell-border-left thead tr-odd tr-last tr-first col-odd" data-line="41" data-row="1" data-col="3" style="font-weight:bold;background-color:LightBlue;text-align:center"><span data-line="41"></span>                                 </th><th class="col cell-border-left thead tr-odd tr-last tr-first col-even col-last" data-line="41" data-row="1" colspan="2" data-col="4" style="font-weight:bold;text-align:center"><span data-line="41"></span> <span style="color:DarkBlue">Semi-automated verifiers of imperative programs</span><span data-line="41"></span> </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="text-align:center"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="text-align:left"></td><td class="tbody tr-even col cell-border-left col-odd" data-row="0" data-col="3" style="background-color:LightBlue;text-align:center"></td><td class="tbody tr-even col cell-border-left cell-line col-even" data-row="0" data-col="4" style="text-align:center"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="0" data-col="5" style="text-align:left"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-line="43" data-row="1" data-col="1" style="text-align:center"><span data-line="43"></span> Coq,                   </td><td class="tbody tr-odd tr-first col col-even" data-line="43" data-row="1" data-col="2" style="text-align:left"><span data-line="43"></span> CompCert,              </td><td class="tbody tr-odd tr-first col cell-border-left col-odd" data-line="43" data-row="1" data-col="3" style="background-color:LightBlue;text-align:center"><span data-line="43"></span> <span data-line="43"></span>&#160;<span data-line="43"></span>&#160;<span data-line="43"></span><em class="em-star1">air</em><span data-line="43"></span>                       </td><td class="tbody tr-odd tr-first col cell-border-left col-even" data-line="43" data-row="1" data-col="4" style="text-align:center"><span data-line="43"></span> Dafny,                           </td><td class="tbody tr-odd tr-first col col-odd col-last" data-line="43" data-row="1" data-col="5" style="text-align:left"><span data-line="43"></span> Verve,                           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-line="44" data-row="2" data-col="1" style="text-align:center"><span data-line="44"></span> Isabelle,              </td><td class="tbody tr-even col col-even" data-line="44" data-row="2" data-col="2" style="text-align:left"><span data-line="44"></span> seL4,                  </td><td class="tbody tr-even col cell-border-left col-odd" data-line="44" data-row="2" data-col="3" style="background-color:LightBlue;text-align:center"><span data-line="44"></span>                                 </td><td class="tbody tr-even col cell-border-left col-even" data-line="44" data-row="2" data-col="4" style="text-align:center"><span data-line="44"></span> FramaC,                          </td><td class="tbody tr-even col col-odd col-last" data-line="44" data-row="2" data-col="5" style="text-align:left"><span data-line="44"></span> IronClad,                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-line="45" data-row="3" data-col="1" style="text-align:center"><span data-line="45"></span> Agda,                  </td><td class="tbody tr-odd col col-even" data-line="45" data-row="3" data-col="2" style="text-align:left"><span data-line="45"></span> Bedrock,               </td><td class="tbody tr-odd col cell-border-left col-odd" data-line="45" data-row="3" data-col="3" style="background-color:LightBlue;text-align:center"><span data-line="45"></span>                                 </td><td class="tbody tr-odd col cell-border-left col-even" data-line="45" data-row="3" data-col="4" style="text-align:center"><span data-line="45"></span> Why3                             </td><td class="tbody tr-odd col col-odd col-last" data-line="45" data-row="3" data-col="5" style="text-align:left"><span data-line="45"></span> miTLS                            </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-line="46" data-row="4" data-col="1" style="text-align:center"><span data-line="46"></span> Lean, PVS, <span data-line="46"></span>&#8230;<span data-line="46"></span>                  </td><td class="tbody tr-even tr-last col col-even" data-line="46" data-row="4" data-col="2" style="text-align:left"><span data-line="46"></span> 4 colors               </td><td class="tbody tr-even tr-last col cell-border-left col-odd" data-line="46" data-row="4" data-col="3" style="background-color:LightBlue;text-align:center"><span data-line="46"></span> <span data-line="46"></span>&#160;<span data-line="46"></span>&#160;<span data-line="46"></span><em class="em-star1">gap</em><span data-line="46"></span>                       </td><td class="tbody tr-even tr-last col cell-border-left col-even" data-line="46" data-row="4" data-col="4" style="text-align:center"><span data-line="46"></span>                                  </td><td class="tbody tr-even tr-last col col-odd col-last" data-line="46" data-row="4" data-col="5" style="text-align:left"><span data-line="46"></span> Vale                             </td></tr></tbody></table>
<ul class="ul list-star loose" data-line="48">
<li class="li ul-li list-star-li loose-li" data-line="48">
<p data-line="48"><span data-line="48"></span><strong class="strong-star2"><span style="color:DarkRed">In the left corner</span></strong><span data-line="48"></span>:
Very expressive dependently-typed logics,<span data-line="49"></span><br>
<span data-line="50"></span>but only purely functional programming
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="52">
<p data-line="52"><span data-line="52"></span><strong class="strong-star2"><span style="color:DarkBlue">In the right</span></strong><span data-line="52"></span>:
effectful programming, SMT-based automation,<span data-line="53"></span><br>
<span data-line="54"></span>but only first-order logic
</p></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-bridging-the-gap--f-" class="section section2" data-section-depth="2" data-line="58"><h3 id="heading-sec-bridging-the-gap--f-" class="h2" data-heading-depth="2" style="display:block">Bridging the gap: F*</h3><!-- General-purpose -->


<ul class="ul list-star loose" data-line="61">
<li class="li ul-li list-star-li loose-li" data-line="61">
<p data-line="61"><span data-line="61"></span><strong class="strong-star2"><span style="color:Black">Functional programming language with effects</span></strong><span data-line="61"></span>
</p>
<ul class="ul list-dash compact" data-line="62">
<li class="li ul-li list-dash-li compact-li" data-line="62"><span data-line="62"></span>like OCaml, F<span data-line="62"></span>#<span data-line="62"></span>, Haskell, <span data-line="62"></span>&#8230;<span data-line="62"></span>
</li>
<li class="li ul-li list-dash-li compact-li" data-line="63"><span data-line="63"></span>F<span data-line="63"></span>*<span data-line="63"></span> extracted to OCaml or F<span data-line="63"></span>#<span data-line="63"></span> by default
</li>
<li class="li ul-li list-dash-li compact-li" data-line="64"><span data-line="64"></span>Subset of F<span data-line="64"></span>*<span data-line="64"></span> compiled to efficient C code
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="66">
<p data-line="66"><span data-line="66"></span><strong class="strong-star2"><span style="color:DarkBlue">Semi-automated verification system using SMT</span></strong><span data-line="66"></span>
</p>
<ul class="ul list-dash compact" data-line="67">
<li class="li ul-li list-dash-li compact-li" data-line="67"><span data-line="67"></span>like Dafny, FramaC, Why3, <span data-line="67"></span>&#8230;<span data-line="67"></span>
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="69">
<p data-line="69"><span data-line="69"></span><strong class="strong-star2"><span style="color:DarkRed">With an expressive core language based on dependent type theory</span></strong><span data-line="69"></span>
</p><!-- - full dependency, inductive types, universe polymorphism -->


<ul class="ul list-dash compact" data-line="71">
<li class="li ul-li list-dash-li compact-li" data-line="71"><span data-line="71"></span>like Coq, Lean, Agda, PVS, <span data-line="71"></span>&#8230;<span data-line="71"></span>
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="73">
<p data-line="73"><span data-line="73"></span><strong class="strong-star2"><span style="color:DarkGreen">New: A metaprogramming and tactic framework for interactive proof and user-defined automation</span></strong><span data-line="73"></span>
</p><!-- - full dependency, inductive types, universe polymorphism -->


<ul class="ul list-dash compact" data-line="75">
<li class="li ul-li list-dash-li compact-li" data-line="75"><span data-line="75"></span>like Coq, Isabelle, Lean, PVS, etc.
</li></ul>
</li></ul>
<!-- * {.fragment} Other tools in this space: -->

<!--   - DML/ATS, HTT, Idris, Trellys/Zombie, CoqHammer, ... -->

<!-- - But F\* is the closest to bridging the gap by nicely integrating these three things -->



<!-------------------------------------------------------------------------------->


</section>
<section id="sec-some-uses-of-f-" class="section section2" data-section-depth="2" data-line="84"><h3 id="heading-sec-some-uses-of-f-" class="h2" data-heading-depth="2" style="display:block">Some uses of F*</h3>
<ul class="ul list-star loose" data-line="86">
<li class="li ul-li list-star-li loose-li" data-line="86">
<p data-line="86"><span data-line="86"></span><strong class="strong-star2"><span style="color:Black">Functional programming language with effects</span></strong><span data-line="86"></span>
</p>
<ul class="ul list-dash compact" data-line="87">
<li class="li ul-li list-dash-li compact-li" data-line="87"><span data-line="87"></span>F<span data-line="87"></span>*<span data-line="87"></span> is programmed in F<span data-line="87"></span>*<span data-line="87"></span> and extracted to OCaml, but not (yet) verified
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="89">
<p data-line="89"><span data-line="89"></span><strong class="strong-star2"><span style="color:DarkBlue">Semi-automated verification system</span></strong><span data-line="89"></span>
</p>
<ul class="ul list-dash compact" data-line="90">
<li class="li ul-li list-dash-li compact-li" data-line="90"><span data-line="90"></span><strong class="strong-star2"><a href="https://project-everest.github.io/">Project Everest</a></strong><span data-line="90"></span>: verify and deploy new, efficient HTTPS stack

<ul class="ul list-dash compact" data-line="91">
<li class="li ul-li list-dash-li compact-li" data-line="91"><span data-line="91"></span><a href="https://github.com/mitls/mitls-fstar">miTLS*</a><span data-line="91"></span>: Verified reference implementation of TLS (1.2 and 1.3)
</li>
<li class="li ul-li list-dash-li compact-li" data-line="92"><span data-line="92"></span><a href="https://github.com/mitls/hacl-star">HACL*</a><span data-line="92"></span>: High-Assurance Cryptographic Library
</li>
<li class="li ul-li list-dash-li compact-li" data-line="93"><span data-line="93"></span><a href="https://github.com/project-everest/vale">Vale</a><span data-line="93"></span>: Verified Assembly Language for Everest
</li></ul></li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="95">
<p data-line="95"><span data-line="95"></span><strong class="strong-star2"><span style="color:DarkRed">Proof assistant based on dependent types and metaprogramming</span></strong><span data-line="95"></span>
</p>
<ul class="ul list-dash compact" data-line="96">
<li class="li ul-li list-dash-li compact-li" data-line="96"><span data-line="96"></span>Semantics and proofs by partial evaluation in Vale
</li>
<li class="li ul-li list-dash-li compact-li" data-line="97"><span data-line="97"></span>Core verification libraries, e.g., for math, state, parsing, formatting
</li>
<li class="li ul-li list-dash-li compact-li" data-line="98"><span data-line="98"></span>Mechanized metatheory, e.g, 

<ul class="ul list-plus compact" data-line="99">
<li class="li ul-li list-plus-li compact-li" data-line="99"><span data-line="99"></span><a href="https://github.com/FStarLang/FStar/blob/stratified_last/examples/metatheory/MicroFStar.fst">MicroFStar</a><span data-line="99"></span>: Fragment of F<span data-line="99"></span>*<span data-line="99"></span> formalized in F<span data-line="99"></span>*<span data-line="99"></span>
</li>
<li class="li ul-li list-plus-li compact-li" data-line="100"><span data-line="100"></span><a href="http://research.microsoft.com/en-us/um/people/nswamy/papers/wys.pdf">Wys*</a><span data-line="100"></span>: Verified DSL for secure multi-party computations
</li>
<li class="li ul-li list-plus-li compact-li" data-line="101"><span data-line="101"></span><a href="https://github.com/msr-quarc/ReVerC">ReVer</a><span data-line="101"></span>: Verified compiler to reversible circuits
</li></ul></li></ul>
</li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-a-first-taste" class="section section2" data-section-depth="2" data-line="105"><h3 id="heading-sec-a-first-taste" class="h2" data-heading-depth="2" style="display:block">A first taste</h3>
<ul class="ul list-star loose" data-line="107">
<li class="li ul-li list-star-li loose-li fragment" data-line="107">
<p data-line="107"><span data-line="107"></span>Write ML-like code
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstar lang-fstar fstar colorized" data-line="108" data-line-first="109" style="display:block"><code data-line="109"><span style="color:blue">let</span> <span style="color:blue">rec</span> factorial n = 
  <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> 
  <span style="color:blue">else</span> n * factorial (n - <span class="constant" style="color:purple">1</span>)</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="114">
<p data-line="114"><span data-line="114"></span>Give it a specification, claiming that <span data-line="114"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">factorial</code><span data-line="114"></span> is a
total function from non-negative to positive integers.<span data-line="115"></span> <span data-line="115"></span> 
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstar lang-fstar fstar colorized" data-line="116" data-line-first="117" style="display:block"><code data-line="117"><span style="color:blue">val</span> factorial<span style="color:teal">:</span> <span style="color:teal">n</span><span style="color:teal">:</span><span style="color:teal">int</span><span style="color:teal">{</span><span style="color:teal">n</span> <span style="color:teal">&gt;=</span> <span style="color:teal">0</span><span style="color:teal">}</span> <span style="color:teal">-&gt;</span> <span style="color:teal">Tot</span> <span style="color:teal">(</span><span style="color:teal">i</span><span style="color:teal">:</span><span style="color:teal">int</span><span style="color:teal">{</span><span style="color:teal">i</span> <span style="color:teal">&gt;=</span> <span style="color:teal">1</span><span style="color:teal">}</span><span style="color:teal">)</span> </code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="120">
<p data-line="120"><span data-line="120"></span>Ask F<span data-line="120"></span>*<span data-line="120"></span> to check it
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="121" data-line-first="122" style="display:block"><code data-line="122">fstar factorial.fst
Verified <span style="color:blue">module</span>: Factorial
All verification conditions discharged successfully</code></pre></li></ul>
<!-------------------------------------------------------------------------------->


</section>
<section class="slide section" data-line="129">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="130" data-line-first="131" style="display:block"><code data-line="131">fstar factorial.fst
Verified <span style="color:blue">module</span>: Factorial
All verification conditions discharged successfully</code></pre><h5 id="sec-f--builds-a-typing-derivation-of-the-form-" class="h4" data-line="136" data-heading-depth="4" style="display:block"><span data-line="136"></span>F<span data-line="136"></span>*<span data-line="136"></span> builds a typing derivation of the form:</h5>
<p class="p noindent" data-line="138"><span data-line="138"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.6085em;height:1.3369em;width:19.2775em" viewBox='34.67 54.722 183.595 12.732' ><desc>$\Gamma_{\mbox{prelude}} \vdash \mbox{\texttt{let factorial n = e}} : t \Leftarrow \phi$</desc><g id='math-b7cc7c'><use x='34.869' xlink:href='#g3-0' y='61.836'/><use x='41.096' xlink:href='#g3-112' y='65.323'/><use x='46.631' xlink:href='#g3-114' y='65.323'/><use x='50.533' xlink:href='#g3-101' y='65.323'/><use x='54.961' xlink:href='#g3-108' y='65.323'/><use x='57.728' xlink:href='#g3-117' y='65.323'/><use x='63.263' xlink:href='#g3-100' y='65.323'/><use x='68.798' xlink:href='#g3-101' y='65.323'/><use x='76.491' xlink:href='#g1-96' y='61.836'/><use x='85.347' xlink:href='#g0-108' y='61.836'/><use x='90.577' xlink:href='#g0-101' y='61.836'/><use x='95.807' xlink:href='#g0-116' y='61.836'/><use x='106.268' xlink:href='#g0-102' y='61.836'/><use x='111.498' xlink:href='#g0-97' y='61.836'/><use x='116.729' xlink:href='#g0-99' y='61.836'/><use x='121.959' xlink:href='#g0-116' y='61.836'/><use x='127.189' xlink:href='#g0-111' y='61.836'/><use x='132.42' xlink:href='#g0-114' y='61.836'/><use x='137.65' xlink:href='#g0-105' y='61.836'/><use x='142.88' xlink:href='#g0-97' y='61.836'/><use x='148.111' xlink:href='#g0-108' y='61.836'/><use x='158.571' xlink:href='#g0-110' y='61.836'/><use x='169.032' xlink:href='#g0-61' y='61.836'/><use x='179.493' xlink:href='#g0-101' y='61.836'/><use x='187.49' xlink:href='#g3-58' y='61.836'/><use x='193.025' xlink:href='#g2-116' y='61.836'/><use x='199.39' xlink:href='#g1-40' y='61.836'/><use x='212.12' xlink:href='#g2-30' y='61.836'/></g></svg><span data-line="138"></span>
</p>
<ul class="ul list-dash loose" data-line="140">
<li class="li ul-li list-dash-li loose-li" data-line="140">
<p data-line="140"><span data-line="140"></span>In a context <span data-line="140"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.6073em;height:1.3223em;width:4.1226em" viewBox='88.468 54.862 39.263 12.593' ><desc>$\Gamma_{\mbox{prelude}}$</desc><g id='math-9df8eb'><use x='88.667' xlink:href='#g3-0' y='61.836'/><use x='94.894' xlink:href='#g3-112' y='65.323'/><use x='100.429' xlink:href='#g3-114' y='65.323'/><use x='104.331' xlink:href='#g3-101' y='65.323'/><use x='108.759' xlink:href='#g3-108' y='65.323'/><use x='111.526' xlink:href='#g3-117' y='65.323'/><use x='117.061' xlink:href='#g3-100' y='65.323'/><use x='122.596' xlink:href='#g3-101' y='65.323'/></g></svg><span data-line="140"></span> including definitions of F<span data-line="140"></span>*<span data-line="140"></span> primitives
</p></li>
<li class="li ul-li list-dash-li loose-li" data-line="142">
<p data-line="142"><span data-line="142"></span>The program <span data-line="142"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.6935em;width:10.4774em" viewBox='34.67 55.489 99.785 6.605' ><desc>$\mbox{\texttt{let factorial n = e}}$</desc><g id='math-5b7bc9'><use x='34.869' xlink:href='#g0-108' y='61.836'/><use x='40.1' xlink:href='#g0-101' y='61.836'/><use x='45.33' xlink:href='#g0-116' y='61.836'/><use x='55.791' xlink:href='#g0-102' y='61.836'/><use x='61.021' xlink:href='#g0-97' y='61.836'/><use x='66.251' xlink:href='#g0-99' y='61.836'/><use x='71.482' xlink:href='#g0-116' y='61.836'/><use x='76.712' xlink:href='#g0-111' y='61.836'/><use x='81.942' xlink:href='#g0-114' y='61.836'/><use x='87.173' xlink:href='#g0-105' y='61.836'/><use x='92.403' xlink:href='#g0-97' y='61.836'/><use x='97.633' xlink:href='#g0-108' y='61.836'/><use x='108.094' xlink:href='#g0-110' y='61.836'/><use x='118.555' xlink:href='#g0-61' y='61.836'/><use x='129.015' xlink:href='#g0-101' y='61.836'/></g></svg><span data-line="142"></span> has type <span data-line="142"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7082em;width:0.4206em" viewBox='34.67 55.4 4.006 6.745' ><desc>$t$</desc><g id='math-e358ef'><use x='34.869' xlink:href='#g2-116' y='61.836'/></g></svg><span data-line="142"></span>,
given the validity of a logical formula <span data-line="143"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.2359em;height:0.9823em;width:0.6662em" viewBox='88.468 54.722 6.345 9.355' ><desc>$\phi$</desc><g id='math-1ed346'><use x='88.667' xlink:href='#g2-30' y='61.836'/></g></svg><span data-line="143"></span>
</p></li>
<li class="li ul-li list-dash-li loose-li" data-line="145">
<p data-line="145"><span data-line="145"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.2359em;height:0.9823em;width:0.6662em" viewBox='88.468 54.722 6.345 9.355' ><desc>$\phi$</desc><g id='math-1ed346'><use x='88.667' xlink:href='#g2-30' y='61.836'/></g></svg><span data-line="145"></span> is passed to<span data-line="145"></span>&nbsp;<a href="http://research.microsoft.com/z3" data-linkid="z3">Z3</a><span data-line="145"></span> (an automated theorem
prover/SMT solver) to check for validity
</p></li>
<li class="li ul-li list-dash-li loose-li" data-line="148">
<p data-line="148"><span data-line="148"></span>If the check succeds, then, from the metatheory of F<span data-line="148"></span>*<span data-line="148"></span>, the program is
safe at type <span data-line="149"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7082em;width:0.4206em" viewBox='34.67 55.4 4.006 6.745' ><desc>$t$</desc><g id='math-e358ef'><use x='34.869' xlink:href='#g2-116' y='61.836'/></g></svg><span data-line="149"></span>
</p></li></ul>
</section><!------------------------------------------------------------------------------>


<section id="sec-running-f--programs" class="section section1" data-section-depth="1" data-line="155"><h2 id="heading-sec-running-f--programs" class="h1" data-heading-depth="1" style="display:block">Running F* Programs</h2><h4 id="sec-extraction-to-ocaml-and-fsharp" class="h3" data-line="157" data-heading-depth="3" style="display:block"><span data-line="157"></span>Extraction to OCaml and FSharp</h4>
<div class="center align-center" data-line="159" style="text-align:center">
<p class="p noindent" data-line="160"><span data-line="160"></span><img src="aux/fstar-compilation-1.png" alt="fstar-compiler-1" data-path="aux/fstar-compilation-1.png" data-linkid="fstar-compiler-1" style="width:500px"></p></div><!------------------------------------------------------------------------------>

</section>
<section id="sec-running-f--programs" class="section section1" data-section-depth="1" data-line="166"><h2 id="heading-sec-running-f--programs" class="h1" data-heading-depth="1" style="display:block">Running F* Programs</h2><h4 id="sec-extraction-to-ocaml-and-fsharp" class="h3" data-line="168" data-heading-depth="3" style="display:block"><span data-line="168"></span>Extraction to OCaml and FSharp</h4><h4 id="sec-extraction-of-a-subset-of-f--to-c" class="h3" data-line="169" data-heading-depth="3" style="display:block"><span data-line="169"></span>Extraction of a subset of F<span data-line="169"></span>*<span data-line="169"></span> to C</h4>
<div class="center align-center" data-line="171" style="text-align:center">
<p class="p noindent" data-line="172"><span data-line="172"></span><img src="aux/fstar-compilation-2.png" alt="fstar-compiler-2" data-path="aux/fstar-compilation-2.png" data-linkid="fstar-compiler-2" style="width:500px"></p></div><!------------------------------------------------------------------------------>


</section>
<section id="sec-the-current-everest-and-f--team" class="section section1" data-section-depth="1" data-line="179"><h2 id="heading-sec-the-current-everest-and-f--team" class="h1" data-heading-depth="1" style="display:block">The Current Everest and F* team</h2>
<div class="center align-center" data-line="181" style="text-align:center">
<p class="p noindent" data-line="182"><span data-line="182"></span><span style="color:DarkGreen"><strong class="strong-star2">Microsoft Research, Inria Paris, CMU, MIT, Rosario, &#8230;</strong></span></p></div><!-- {font-size:xx-large} -->


<table class="columns block" data-line="187">
<tbody><tr><td class="column" data-line="188">
<ul class="ul list-dash compact" data-line="189">
<li class="li ul-li list-dash-li compact-li" data-line="189"><span data-line="189"></span>Danel Ahman
</li>
<li class="li ul-li list-dash-li compact-li" data-line="190"><span data-line="190"></span>Barry Bond
</li>
<li class="li ul-li list-dash-li compact-li" data-line="191"><span data-line="191"></span>Jay Bosamiya
</li>
<li class="li ul-li list-dash-li compact-li" data-line="192"><span data-line="192"></span>Benjamin Beurdouche
</li>
<li class="li ul-li list-dash-li compact-li" data-line="193"><span data-line="193"></span>Karthikeyan Bhargavan
</li>
<li class="li ul-li list-dash-li compact-li" data-line="194"><span data-line="194"></span>Antoine Delignat-Lavaud
</li>
<li class="li ul-li list-dash-li compact-li" data-line="195"><span data-line="195"></span>Victor Dumitrescu
</li>
<li class="li ul-li list-dash-li compact-li" data-line="196"><span data-line="196"></span>Cédric Fournet
</li>
<li class="li ul-li list-dash-li compact-li" data-line="197"><span data-line="197"></span>Aymeric Fromherz
</li>
<li class="li ul-li list-dash-li compact-li" data-line="198"><span data-line="198"></span>Chris Hawblitzel
</li>
<li class="li ul-li list-dash-li compact-li" data-line="199"><span data-line="199"></span>Cătălin Hriţcu
</li>
<li class="li ul-li list-dash-li compact-li" data-line="200"><span data-line="200"></span>Markulf Kohlweiss</li></ul></td><td class="column" data-line="202">
<ul class="ul list-dash compact" data-line="203">
<li class="li ul-li list-dash-li compact-li" data-line="203"><span data-line="203"></span>Qunyan Mangus
</li>
<li class="li ul-li list-dash-li compact-li" data-line="204"><span data-line="204"></span>Kenji Maillard
</li>
<li class="li ul-li list-dash-li compact-li" data-line="205"><span data-line="205"></span>Guido Martínez
</li>
<li class="li ul-li list-dash-li compact-li" data-line="206"><span data-line="206"></span>Bryan Parno
</li>
<li class="li ul-li list-dash-li compact-li" data-line="207"><span data-line="207"></span>Clément Pit-Claudel
</li>
<li class="li ul-li list-dash-li compact-li" data-line="208"><span data-line="208"></span>Jonathan Protzenko
</li>
<li class="li ul-li list-dash-li compact-li" data-line="209"><span data-line="209"></span>Tahina Ramananandro
</li>
<li class="li ul-li list-dash-li compact-li" data-line="210"><span data-line="210"></span>Aseem Rastogi
</li>
<li class="li ul-li list-dash-li compact-li" data-line="211"><span data-line="211"></span>Nikhil Swamy
</li>
<li class="li ul-li list-dash-li compact-li" data-line="212"><span data-line="212"></span>Gustavo Varo
</li>
<li class="li ul-li list-dash-li compact-li" data-line="213"><span data-line="213"></span>Christoph M. Wintersteiger
</li>
<li class="li ul-li list-dash-li compact-li" data-line="214"><span data-line="214"></span>Santiago Zanella-Béguelin</li></ul></td></tr></tbody></table>
<ul class="ul list-plus compact" data-line="218">
<li class="li ul-li list-plus-li compact-li" data-line="218"><span data-line="218"></span>many former members, interns, external contributors, <span data-line="218"></span>&#8230;<span data-line="218"></span> you?
</li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-the-rest-of-this-lecture" class="section section2" data-section-depth="2" data-line="222"><h3 id="heading-sec-the-rest-of-this-lecture" class="h2" data-heading-depth="2" style="display:block">The rest of this lecture</h3><h4 id="sec-today" class="h3" data-line="224" data-heading-depth="3" style="display:block"><span data-line="224"></span>Today</h4>
<ul class="ul list-star loose" data-line="226">
<li class="li ul-li list-star-li loose-li" data-line="226">
<p data-line="226"><span data-line="226"></span>The functional core of F<span data-line="226"></span>*<span data-line="226"></span>
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="228">
<p data-line="228"><span data-line="228"></span>Several style of proof illustrated on simple functional programs
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="230">
<p data-line="230"><span data-line="230"></span>Simple verified stateful programming
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="232">
<p data-line="232"><span data-line="232"></span>A taste of F<span data-line="232"></span>*<span data-line="232"></span>&#39;<span data-line="232"></span>s encoding to SMT
</p></li></ul>
<h4 id="sec-tomorrow" class="h3" data-line="234" data-heading-depth="3" style="display:block"><span data-line="234"></span>Tomorrow</h4>
<ul class="ul list-star compact" data-line="236">
<li class="li ul-li list-star-li compact-li" data-line="236"><span data-line="236"></span>Verified low-level programming in a C-like subset of F<span data-line="236"></span>*<span data-line="236"></span>
</li></ul>
<!----------------------------------------------------------------------------


## Functional core of F\* ## {#fcore}

* **[Variant of dependent type theory]{color:DarkBlue}**
  - $\lambda$, $\Pi$, inductives, matches, universe polymorphism

* {.fragment} **[Recursion and semantic termination check]{color:DarkRed}**
  - potential non-termination is an effect

* {.fragment} **[Refinements]{color:DarkRed}**
  - **Refined value types**: `x:t{p}`
  - **Refined computation types**: `Pure t pre post`
  - computationally and proof irrelevant, discharged by SMT

* {.fragment} **[Subtyping and sub-effecting]{color:DarkRed}**, **[Extensional equality]{color:DarkRed}**

<!------------------------------------------------------------------------------>


</section>
<section id="sec-the-functional-core-of-f-" class="section section2" data-section-depth="2" data-line="258"><h3 id="heading-sec-the-functional-core-of-f-" class="h2" data-heading-depth="2" style="display:block">The functional core of F*</h3>
<ul class="ul list-star loose" data-line="260">
<li class="li ul-li list-star-li loose-li fragment" data-line="260">
<p data-line="260"><span data-line="260"></span>Recursive functions
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="261" data-line-first="262" style="display:block"><code data-line="262"><span style="color:blue">val</span> factorial : int <span style="color:blue">-&gt;</span> int
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial n = (<span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>)))</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="266">
<p data-line="266"><span data-line="266"></span>Inductive datatypes (immutable) and pattern matching
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="267" data-line-first="268" style="display:block"><code data-line="268"><span style="color:blue">type</span> list (a:<span style="color:blue">Type</span>) =
  | Nil  : list a
  | Cons : hd:a <span style="color:blue">-&gt;</span> tl:list a <span style="color:blue">-&gt;</span> list a

<span style="color:blue">val</span> map : (<span style="color:red">&#39;</span>a <span style="color:blue">-&gt;</span> <span style="color:red">&#39;</span>b) <span style="color:blue">-&gt;</span> list <span style="color:red">&#39;</span>a <span style="color:blue">-&gt;</span> list <span style="color:red">&#39;</span>b
<span style="color:blue">let</span> <span style="color:blue">rec</span> map f x = <span style="color:blue">match</span> x <span style="color:blue">with</span>
  | [] <span style="color:blue">-&gt;</span> []
  | h :: t <span style="color:blue">-&gt;</span> f h :: map f t</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="278">
<p data-line="278"><span data-line="278"></span>Lambdas (unnamed, first-class functions)
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="279" data-line-first="280" style="display:block"><code data-line="280">map (<span style="color:blue">fun</span> x <span style="color:blue">-&gt;</span> x + <span class="constant" style="color:purple">42</span>) [<span class="constant" style="color:purple">1</span>;<span class="constant" style="color:purple">2</span>;<span class="constant" style="color:purple">3</span>]</code></pre></li></ul>
<!------------------------------------------------------------------------------>


<!-- ## Beyond ML types ## -->


</section>
<section id="sec-refinement-types" class="section section2" data-section-depth="2" data-line="287"><h3 id="heading-sec-refinement-types" class="h2" data-heading-depth="2" style="display:block">Refinement types</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="289" data-line-first="290" style="display:block"><code data-line="290"><span style="color:blue">type</span> nat = x:int{x&gt;=<span class="constant" style="color:purple">0</span>}</code></pre>
<ul class="ul list-star loose" data-line="292">
<li class="li ul-li list-star-li loose-li fragment" data-line="292">
<p data-line="292"><span data-line="292"></span>Refinements introduced by type annotations (code unchanged)
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="293" data-line-first="294" style="display:block"><code data-line="294"><span style="color:blue">val</span> factorial : nat <span style="color:blue">-&gt;</span> nat
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial n = (<span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>)))</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="298">
<p data-line="298"><span data-line="298"></span>Logical obligations discharged by SMT (simplified)
</p>
<pre class="para-block pre-fenced pre-fenced3 language-text lang-text text" data-line="299" data-line-first="300" style="display:block"><code data-line="300">n &gt;= 0, n &lt;&gt; 0 |= n - 1 &gt;= 0
n &gt;= 0, n &lt;&gt; 0, factorial (n - 1) &gt;= 0 |= n * (factorial (n - 1)) &gt;= 0</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="304">
<p data-line="304"><span data-line="304"></span>Refinements eliminated by <span data-line="304"></span><strong class="strong-star2">subtyping</strong><span data-line="304"></span>: <span data-line="304"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">nat&lt;:int</code><span data-line="304"></span>
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="305" data-line-first="306" style="display:block"><code data-line="306"><span style="color:blue">let</span> i : int = factorial <span class="constant" style="color:purple">42</span>
<span style="color:blue">let</span> f : x:nat{x&gt;<span class="constant" style="color:purple">0</span>} <span style="color:blue">-&gt;</span> int = factorial</code></pre></li></ul>
</section>
<section id="sec-dependent-types" class="section section2" data-section-depth="2" data-line="310"><h3 id="heading-sec-dependent-types" class="h2" data-heading-depth="2" style="display:block">Dependent types</h3>
<ul class="ul list-star loose" data-line="312">
<li class="li ul-li list-star-li loose-li" data-line="312">
<p data-line="312"><span data-line="312"></span>Dependent function types (<span data-line="312"></span><svg  class="math-inline math-render-svg math" style="vertical-align:-0.0210em;height:0.7532em;width:0.8274em" viewBox='34.67 54.862 7.88 7.173' ><desc>$\Pi$</desc><g id='math-d744af'><use x='34.869' xlink:href='#g1-5' y='61.836'/></g></svg><span data-line="312"></span>), here together with refinements:
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="313" data-line-first="314" style="display:block"><code data-line="314"><span style="color:blue">val</span> incr : x:int <span style="color:blue">-&gt;</span> y:int{x &lt; y}
<span style="color:blue">let</span> incr x = x + <span class="constant" style="color:purple">1</span></code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="318">
<p data-line="318"><span data-line="318"></span>Can express pre- and post- conditions of pure functions
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="319" data-line-first="320" style="display:block"><code data-line="320"><span style="color:blue">val</span> incr : x:int <span style="color:blue">-&gt;</span> y:int{y = x + <span class="constant" style="color:purple">1</span>}</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="323">
<p data-line="323"><span data-line="323"></span>Exercise: Can you find other types for <span data-line="323"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">incr</code><span data-line="323"></span>?
</p></li></ul>
</section>
<section id="sec-total-functions-in-f-" class="section section2" data-section-depth="2" data-line="326"><h3 id="heading-sec-total-functions-in-f-" class="h2" data-heading-depth="2" style="display:block">Total functions in F*</h3>
<ul class="ul list-star loose" data-line="328">
<li class="li ul-li list-star-li loose-li" data-line="328">
<p data-line="328"><span data-line="328"></span>The F<span data-line="328"></span>*<span data-line="328"></span> functions we saw so far were all <span data-line="328"></span><strong class="strong-star2">total</strong><span data-line="328"></span>
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="330">
<p data-line="330"><span data-line="330"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Tot</span></code><span data-line="330"></span> effect (default) = no side-effects, terminates on all inputs
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="332" data-line-first="333" style="display:block"><code data-line="333"><span style="color:blue">val</span> factorial : nat <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> nat
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial n = (<span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>)))</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="337">
<p data-line="337"><span data-line="337"></span>Quiz: How about giving this weak type to factorial?
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="338" data-line-first="339" style="display:block"><code data-line="339"><span style="color:blue">val</span> factorial : int <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> int</code></pre></li></ul>

<div class="fragment console" data-line="342">
<pre class="para-block pre-fenced pre-fenced3 language-text lang-text text" data-line="343" data-line-first="344" style="display:block"><code data-line="344">  let rec factorial n = (if n = 0 then 1 else n * (factorial (n - 1)))
                                                              ^^^^^
  Subtyping check failed; expected type (x:int{(x &lt;&lt; n)}); got type int</code></pre>
<p class="p noindent para-continued" data-line="348"><span data-line="348"></span>  <span data-line="348"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">factorial (-<span class="constant" style="color:purple">1</span>)</code><span data-line="348"></span> loops! (<span data-line="348"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">int</code><span data-line="348"></span> type in F<span data-line="348"></span>*<span data-line="348"></span> is unbounded)</p></div></section>
<section id="sec-semantic-termination-checking" class="section section2" data-section-depth="2" data-line="351"><h3 id="heading-sec-semantic-termination-checking" class="h2" data-heading-depth="2" style="display:block">Semantic termination checking</h3>
<ul class="ul list-star compact" data-line="353">
<li class="li ul-li list-star-li compact-li" data-line="353"><span data-line="353"></span>based on <span data-line="353"></span><strong class="strong-star2">well-founded ordering on expressions</strong><span data-line="353"></span> (<span data-line="353"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">&lt;&lt;</code><span data-line="353"></span>)

<ul class="ul list-dash compact" data-line="354">
<li class="li ul-li list-dash-li compact-li" data-line="354"><span data-line="354"></span>naturals related by <span data-line="354"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">&lt;</code><span data-line="354"></span> (negative integers unrelated)
</li>
<li class="li ul-li list-dash-li compact-li" data-line="355"><span data-line="355"></span>inductives related by subterm ordering
</li>
<li class="li ul-li list-dash-li compact-li" data-line="356"><span data-line="356"></span>lex tuples <span data-line="356"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">%[a;b;c]</code><span data-line="356"></span> with lexicographic ordering
</li></ul></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="357"><span data-line="357"></span>order constraints discharged by the SMT solver
</li>
<li class="li ul-li list-star-li compact-li fragment" data-line="358"><span data-line="358"></span>arbitrary total expression as <span data-line="358"></span><strong class="strong-star2">decreases metric</strong><span data-line="358"></span>

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="359" data-line-first="360" style="display:block"><code data-line="360"><span style="color:blue">val</span> ackermann: m:nat <span style="color:blue">-&gt;</span> n:nat <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> nat (<span style="color:blue">decreases</span> %[m;n])
<span style="color:blue">let</span> <span style="color:blue">rec</span> ackermann m n =
  <span style="color:blue">if</span> m=<span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> n + <span class="constant" style="color:purple">1</span>
  <span style="color:blue">else</span> <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> ackermann (m - <span class="constant" style="color:purple">1</span>) <span class="constant" style="color:purple">1</span>
  <span style="color:blue">else</span> ackermann (m - <span class="constant" style="color:purple">1</span>) (ackermann m (n - <span class="constant" style="color:purple">1</span>))</code></pre></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="366"><span data-line="366"></span>default metric is lex ordering of all (non-function) args

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="367" data-line-first="368" style="display:block"><code data-line="368"><span style="color:blue">val</span> ackermann: m:nat <span style="color:blue">-&gt;</span> n:nat <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> nat</code></pre></li></ul>
<!------------------------------------------------------------------------------->


</section>
<section id="sec-values-and-computations" class="section section2" data-section-depth="2" data-line="373"><h3 id="heading-sec-values-and-computations" class="h2" data-heading-depth="2" style="display:block">Values and Computations</h3>
<ul class="ul list-star loose" data-line="375">
<li class="li ul-li list-star-li loose-li" data-line="375">
<p data-line="375"><span data-line="375"></span>&#8220;Values&#8221;<span data-line="375"></span> aka unconditionally total terms
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="377">
<p data-line="377"><span data-line="377"></span><strong class="strong-star2">Two classes of types</strong><span data-line="377"></span>
</p>
<ul class="ul list-dash compact" data-line="378">
<li class="li ul-li list-dash-li compact-li" data-line="378"><span data-line="378"></span>Value types (<span data-line="378"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">t</code><span data-line="378"></span>): <span data-line="378"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">int</code><span data-line="378"></span>, <span data-line="378"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">list int</code><span data-line="378"></span>, <span data-line="378"></span>&#8230;<span data-line="378"></span>
</li>
<li class="li ul-li list-dash-li compact-li" data-line="379"><span data-line="379"></span>Computation types (<span data-line="379"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">C</code><span data-line="379"></span>): conditionally pure, divergent, stateful, <span data-line="379"></span>&#8230;<span data-line="379"></span>
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="381">
<p data-line="381"><span data-line="381"></span><strong class="strong-star2">Dependent function types</strong><span data-line="381"></span> of the form: <span data-line="381"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">x:t <span style="color:blue">-&gt;</span> C</code><span data-line="381"></span>
</p>
<ul class="ul list-dash compact" data-line="382">
<li class="li ul-li list-dash-li compact-li" data-line="382"><span data-line="382"></span>F<span data-line="382"></span>*<span data-line="382"></span> is call-by-value
</li>
<li class="li ul-li list-dash-li compact-li" data-line="383"><span data-line="383"></span>argument can<span data-line="383"></span>&#39;<span data-line="383"></span>t have side-effects, so value type
</li></ul>
</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="385">
<p data-line="385"><span data-line="385"></span><strong class="strong-star2">Two forms of refinement types</strong><span data-line="385"></span>
</p>
<ul class="ul list-dash compact" data-line="386">
<li class="li ul-li list-dash-li compact-li" data-line="386"><span data-line="386"></span><strong class="strong-star2">Refined value types</strong><span data-line="386"></span>: <span data-line="386"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">x:t{p}</code><span data-line="386"></span>
</li>
<li class="li ul-li list-dash-li compact-li" data-line="387"><span data-line="387"></span><strong class="strong-star2">Refined computation types</strong><span data-line="387"></span>:

<ul class="ul list-dash compact" data-line="388">
<li class="li ul-li list-dash-li compact-li" data-line="388"><span data-line="388"></span>Conditionally pure computations: <span data-line="388"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Pure</span> t pre post</code><span data-line="388"></span>
</li>
<li class="li ul-li list-dash-li compact-li" data-line="389"><span data-line="389"></span>these will get more interesting for more interesting effects
</li></ul></li></ul>
</li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="pure1" class="section section2" data-section-depth="2" data-line="394"><h3 id="heading-pure1" class="h2" data-heading-depth="2" style="display:block">Refined Computation Types</h3>
<ul class="ul list-star loose" data-line="396">
<li class="li ul-li list-star-li loose-li" data-line="396">
<p data-line="396"><span data-line="396"></span>Saw this already:
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="397" data-line-first="398" style="display:block"><code data-line="398"><span style="color:blue">val</span> factorial : nat <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> nat</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="401">
<p data-line="401"><span data-line="401"></span>Can equivalently use pre- and post- conditions for this
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="402" data-line-first="403" style="display:block"><code data-line="403"><span style="color:blue">val</span> factorial : x:int <span style="color:blue">-&gt;</span> <span style="color:blue">Pure</span> int (<span style="color:blue">requires</span> (x &gt;= <span class="constant" style="color:purple">0</span>))
                                  (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> y <span style="color:blue">-&gt;</span> y &gt;= <span class="constant" style="color:purple">0</span>))</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="406">
<p data-line="406"><span data-line="406"></span>Each <span data-line="406"></span><strong class="strong-star2">computation type</strong><span data-line="406"></span> contains
</p>
<ul class="ul list-dash compact" data-line="407">
<li class="li ul-li list-dash-li compact-li" data-line="407"><span data-line="407"></span><em class="em-star1">effect</em><span data-line="407"></span> (<span data-line="407"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Pure</span></code><span data-line="407"></span>), <span data-line="407"></span><em class="em-star1">result type</em><span data-line="407"></span> (<span data-line="407"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">int</code><span data-line="407"></span>),
 <span data-line="408"></span><em class="em-star1">spec</em><span data-line="408"></span> (e.g. pre and post)
</li></ul></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="409">
<p data-line="409"><span data-line="409"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Tot</span></code><span data-line="409"></span> can be seen as just an abbreviation
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="410" data-line-first="411" style="display:block"><code data-line="411"><span style="color:blue">Tot</span> t = <span style="color:blue">Pure</span> t (<span style="color:blue">requires</span> True) (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-intrinsic-vs-extrinsic-proofs" class="section section2" data-section-depth="2" data-line="416"><h3 id="heading-sec-intrinsic-vs-extrinsic-proofs" class="h2" data-heading-depth="2" style="display:block">Intrinsic vs Extrinsic Proofs</h3>
<ul class="ul list-star compact" data-line="418">
<li class="li ul-li list-star-li compact-li" data-line="418">
<p data-line="418"><span data-line="418"></span>Intrinsic proof: The type of a term at the <span data-line="418"></span>&#8220;definition site&#8221;<span data-line="418"></span> expresses
properties of interest
</p>
<div class="fragment" data-line="421">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="422" data-line-first="423" style="display:block"><code data-line="423"><span style="color:blue">let</span> <span style="color:blue">rec</span> factorial (n:nat) : <span style="color:blue">Tot</span> nat = <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * factorial (n - <span class="constant" style="color:purple">1</span>)</code></pre></div></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="427"><span data-line="427"></span>Extrinsic proof: The type of a term is relatively simple; properties
are proven separately from the definition
</li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="pure2" class="section section2" data-section-depth="2" data-line="432"><h3 id="heading-pure2" class="h2" data-heading-depth="2" style="display:block">Lemma: Pure Computations as Extrinsic Proofs</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="434" data-line-first="435;out/fstar-sri\aux/AppendLength.fst:10" style="display:block"><code data-line="435;out/fstar-sri\aux/AppendLength.fst:10"><span style="color:blue">let</span> <span style="color:blue">rec</span> append (#a:<span style="color:blue">Type</span>) (xs ys : list a) : <span style="color:blue">Tot</span> (list a) =
  <span style="color:blue">match</span> xs <span style="color:blue">with</span>
  | [] <span style="color:blue">-&gt;</span> ys
  | x :: xs&#39; <span style="color:blue">-&gt;</span> x :: append xs&#39; ys</code></pre>
<div class="fragment" data-line="437">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="438" data-line-first="439;out/fstar-sri\aux/AppendLength.fst:20" style="display:block"><code data-line="439;out/fstar-sri\aux/AppendLength.fst:20"><span style="color:blue">let</span> <span style="color:blue">rec</span> append_length (#a:<span style="color:blue">Type</span>) (xs ys : list a) :
    <span style="color:blue">Pure</span> unit
      (<span style="color:blue">requires</span> True)
      (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> length (append xs ys) = length xs + length ys))
= <span style="color:blue">match</span> xs <span style="color:blue">with</span>
  | [] <span style="color:blue">-&gt;</span> ()
  | x :: xs&#39; <span style="color:blue">-&gt;</span> append_length xs&#39; ys</code></pre></div>
<ul class="ul list-star compact" data-line="442">
<li class="li ul-li list-star-li compact-li fragment" data-line="442"><span data-line="442"></span>Syntax sugar (<span data-line="442"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Lemma</span></code><span data-line="442"></span>)

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="443" data-line-first="444;out/fstar-sri\aux/AppendLength.fst:28" style="display:block"><code data-line="444;out/fstar-sri\aux/AppendLength.fst:28"><span style="color:blue">let</span> <span style="color:blue">rec</span> append_length_lemma (#a:<span style="color:blue">Type</span>) (xs ys : list a) :
  <span style="color:blue">Lemma</span> (<span style="color:blue">ensures</span> (length (append xs ys) = length xs + length ys))
= <span style="color:blue">match</span> xs <span style="color:blue">with</span>
| [] <span style="color:blue">-&gt;</span> ()
| x :: xs&#39; <span style="color:blue">-&gt;</span> append_length_lemma xs&#39; ys</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-often-lemmas-are-unavoidable" class="section section2" data-section-depth="2" data-line="449"><h3 id="heading-sec-often-lemmas-are-unavoidable" class="h2" data-heading-depth="2" style="display:block">Often lemmas are unavoidable</h3><!-- need lemma for 3 reasons:
- as before, this property is rather arbitrary
- this property is "relational" (2 calls to reverse)
- proof doesn't follow the structure of the program
-->


<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="455" data-line-first="456" style="display:block"><code data-line="456"><span style="color:blue">let</span> snoc l h = l @ [h]

<span style="color:blue">let</span> <span style="color:blue">rec</span> reverse (#a:<span style="color:blue">Type</span>) (l:list a) : <span style="color:blue">Tot</span> (list a) =
  <span style="color:blue">match</span> l <span style="color:blue">with</span>
  | [] <span style="color:blue">-&gt;</span> []
  | hd::tl <span style="color:blue">-&gt;</span> snoc (reverse tl) hd</code></pre>
<div class="fragment" data-line="463">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="464" data-line-first="465" style="display:block"><code data-line="465"><span style="color:blue">let</span> <span style="color:blue">rec</span> rev_snoc #a (l:list a) (h:a)
    : <span style="color:blue">Lemma</span> (reverse (snoc l h) == h::reverse l) =
    <span style="color:blue">match</span> l <span style="color:blue">with</span>
    | [] <span style="color:blue">-&gt;</span> ()
    | hd::tl <span style="color:blue">-&gt;</span> rev_snoc tl h</code></pre></div>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="472" data-line-first="473" style="display:block"><code data-line="473"><span style="color:blue">let</span> <span style="color:blue">rec</span> rev_involutive #a (l:list a)
    : <span style="color:blue">Lemma</span> (reverse (reverse l) == l) =
    <span style="color:blue">match</span> l <span style="color:blue">with</span>
    | [] <span style="color:blue">-&gt;</span> ()
    | hd::tl <span style="color:blue">-&gt;</span> rev_involutive tl; rev_snoc (reverse tl) hd</code></pre><!------------------------------------------------------------------------------>


</section>
<section id="pure3" class="section section2" data-section-depth="2" data-line="482"><h3 id="heading-pure3" class="h2" data-heading-depth="2" style="display:block">Verifying pure programs</h3><h4 id="sec-variant-3--extrinsically-using-proof-terms" class="h3" data-line="483" data-heading-depth="3" style="display:block"><span data-line="483"></span>Variant <span data-line="483"></span>#<span data-line="483"></span>3: extrinsically using proof terms</h4>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="485" data-line-first="486" style="display:block"><code data-line="486"><span style="color:blue">let</span> <span style="color:blue">rec</span> preservation (#e #e&#39;:exp) (#g:env) (#t:typ)
                     (ht:typing g e t)
                     (hs:step e e&#39;)
    : <span style="color:blue">Tot</span> (typing g e&#39; t) (<span style="color:blue">decreases</span> ht) =
    <span style="color:blue">match</span> hs <span style="color:blue">with</span>
    | SBeta tx e1&#39; e2&#39; <span style="color:blue">-&gt;</span> substitution_beta h2 (TyLam?.hbody h1)
    | SApp1 e2&#39; hs1   <span style="color:blue">-&gt;</span> TyApp (preservation h1 hs1) h2
    | SApp2 e1&#39; hs2   <span style="color:blue">-&gt;</span> TyApp h1 (preservation h2 hs2)</code></pre>
<div class="fragment" data-line="496">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="497" data-line-first="498" style="display:block"><code data-line="498"><span style="color:blue">let</span> <span style="color:blue">rec</span> progress (#e:exp) (#t:typ) 
                 (h:typing empty e t)
    : <span style="color:blue">Pure</span> (e&#39;:exp &amp; step e e&#39;)
           (<span style="color:blue">requires</span> (~ (is_value e)))
           (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True)) (<span style="color:blue">decreases</span> h) =
    <span style="color:blue">match</span> h <span style="color:blue">with</span>
    | TyApp #g #e1 #e2 #t11 #t12 h1 h2 <span style="color:blue">-&gt;</span>
       <span style="color:blue">match</span> e1 <span style="color:blue">with</span>
       | ELam t e1&#39; <span style="color:blue">-&gt;</span> (| subst (sub_beta e2) e1&#39;, SBeta t e1&#39; e2 |)
       | _          <span style="color:blue">-&gt;</span> <span style="color:blue">let</span> ExIntro e1&#39; h1&#39; = progress h1 <span style="color:blue">in</span>
                       (| EApp e1&#39; e2, SApp1 e2 h1&#39; |)a</code></pre></div>
<ul class="ul list-star compact" data-line="512">
<li class="li ul-li list-star-li compact-li fragment" data-line="512"><span data-line="512"></span><strong class="strong-star2">Note:</strong><span data-line="512"></span> match exhaustiveness check also semantic (via SMT)
</li></ul>
<!-------------------------------------------------------------------------------->


</section>
<section id="sec-the-divergence-effect-dv" class="section section2" data-section-depth="2" data-line="516"><h3 id="heading-sec-the-divergence-effect-dv" class="h2" data-heading-depth="2" style="display:block">The divergence effect (Dv)</h3>
<ul class="ul list-star compact" data-line="518">
<li class="li ul-li list-star-li compact-li" data-line="518"><span data-line="518"></span>Some useful code really is not always terminating

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="519" data-line-first="520" style="display:block"><code data-line="520"><span style="color:blue">val</span> eval : exp <span style="color:blue">-&gt;</span> <span style="color:blue">Dv</span> exp
<span style="color:blue">let</span> <span style="color:blue">rec</span> eval e =
  <span style="color:blue">match</span> e <span style="color:blue">with</span>
  | App (Lam x e1) e2 <span style="color:blue">-&gt;</span> eval (subst x e2 e1)
  | App e1 e2 <span style="color:blue">-&gt;</span> eval (App (eval e1) e2)
  | Lam x e1 <span style="color:blue">-&gt;</span> Lam x (eval e1)
  | _ <span style="color:blue">-&gt;</span> e
<span style="color:blue">let</span> main = eval (App (Lam <span class="constant" style="color:purple">0</span> (App (Var <span class="constant" style="color:purple">0</span>) (Var <span class="constant" style="color:purple">0</span>)))
                     (Lam <span class="constant" style="color:purple">0</span> (App (Var <span class="constant" style="color:purple">0</span>) (Var <span class="constant" style="color:purple">0</span>))))</code></pre>
<div class="fragment console" data-line="530">
<pre class="para-block pre-fenced pre-fenced3 language-text lang-text text" data-line="531" data-line-first="532" style="display:block"><code data-line="532">./Divergence.exe</code></pre></div></li></ul>
</section>
<section id="sec-f--effect-system-encapsulates-effectful-code" class="section section2" data-section-depth="2" data-line="536"><h3 id="heading-sec-f--effect-system-encapsulates-effectful-code" class="h2" data-heading-depth="2" style="display:block">F* effect system encapsulates effectful code</h3>
<ul class="ul list-star loose" data-line="538">
<li class="li ul-li list-star-li loose-li" data-line="538">
<p data-line="538"><span data-line="538"></span>Pure code cannot call potentially divergent code
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="540">
<p data-line="540"><span data-line="540"></span>Only pure code can appear in specifications
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="541" data-line-first="542" style="display:block"><code data-line="542"><span style="color:blue">val</span> eval : expr <span style="color:blue">-&gt;</span> <span style="color:blue">Dv</span> expr</code></pre>
<div class="block console" data-line="544">
<pre class="para-block pre-fenced pre-fenced3 language-text lang-text text" data-line="545" data-line-first="546" style="display:block"><code data-line="546">    type tau = e:expr{e = eval e&#39;}
                          ^^^^^^
Expected a pure expression; got an expression ... with effect &quot;DIV&quot;</code></pre></div><!-- Cheating quite badly above since I don't want to tell them about ghost -->


</li>
<li class="li ul-li list-star-li loose-li fragment" data-line="553">
<p data-line="553"><span data-line="553"></span>Sub-effecting: <span data-line="553"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Tot</span> t &lt;: <span style="color:blue">Dv</span> t</code><span data-line="553"></span><br>
<span data-line="554"></span>(e.g. divergent code can include pure code)
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="555" data-line-first="556" style="display:block"><code data-line="556"><span style="color:blue">val</span> subst : list (var * expr) <span style="color:blue">-&gt;</span> expr <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> expr
eval (subst [x, Num <span class="constant" style="color:purple">0</span>] e) : <span style="color:blue">Dv</span> expr</code></pre></li></ul>
<!-------------------------------------------------------------------------------->


</section>
<section id="sec-verifying-potentially-divergent-programs" class="section section2" data-section-depth="2" data-line="562"><h3 id="heading-sec-verifying-potentially-divergent-programs" class="h2" data-heading-depth="2" style="display:block">Verifying potentially divergent programs</h3><h4 id="sec-partial-correctness" class="h3" data-line="563" data-heading-depth="3" style="display:block"><span data-line="563"></span>(partial correctness)</h4>
<ul class="ul list-star compact" data-line="565">
<li class="li ul-li list-star-li compact-li" data-line="565"><span data-line="565"></span>Using refinement types

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="566" data-line-first="567" style="display:block"><code data-line="567"><span style="color:blue">val</span> factorial : nat <span style="color:blue">-&gt;</span> <span style="color:blue">Dv</span> nat</code></pre></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="569"><span data-line="569"></span>Or the <span data-line="569"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Div</span></code><span data-line="569"></span> computation type (pre- and post- conditions)

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="570" data-line-first="571" style="display:block"><code data-line="571"><span style="color:blue">val</span> eval_closed : e:exp <span style="color:blue">-&gt;</span> <span style="color:blue">Div</span> exp (<span style="color:blue">requires</span> (closed e))
                                   (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> e&#39; <span style="color:blue">-&gt;</span> Lam? e&#39; /\ closed e&#39;))
<span style="color:blue">let</span> <span style="color:blue">rec</span> eval_closed e =
  <span style="color:blue">match</span> e <span style="color:blue">with</span>
  | App e1 e2 <span style="color:blue">-&gt;</span> <span style="color:blue">let</span> Lam e1&#39; = eval_closed e1 <span style="color:blue">in</span>
                 below_subst_beta <span class="constant" style="color:purple">0</span> e1&#39; e2;
                 eval_closed (subst (sub_beta e2) e1&#39;)
  | Lam e1 <span style="color:blue">-&gt;</span> Lam e1</code></pre></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="580"><span data-line="580"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized"><span style="color:blue">Dv</span></code><span data-line="580"></span> just an abbreviation

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="581" data-line-first="582" style="display:block"><code data-line="582"><span style="color:blue">Dv</span> t = <span style="color:blue">Div</span> t (<span style="color:blue">requires</span> True) (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-monadic-effects-in-f-" class="section section2" data-section-depth="2" data-line="587"><h3 id="heading-sec-monadic-effects-in-f-" class="h2" data-heading-depth="2" style="display:block">Monadic effects in F*</h3><!-- Effects defined using monads from total functions -->


<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="590" data-line-first="591" style="display:block"><code data-line="591"><span style="color:blue">type</span> st (a:<span style="color:blue">Type</span>) = heap <span style="color:blue">-&gt;</span> <span style="color:blue">Tot</span> (a * heap)</code></pre>
<div class="fragment" data-line="594">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="595" data-line-first="596" style="display:block"><code data-line="596"><span style="color:blue">new_effect</span> {
 <span style="color:blue">STATE</span> : a:<span style="color:blue">Type</span> <span style="color:blue">-&gt;</span> Effect
 <span style="color:blue">with</span> repr = st;
      return = <span style="color:blue">fun</span> (a:<span style="color:blue">Type</span>) (x:a) (h:heap) <span style="color:blue">-&gt;</span> x, h;
      bind = <span style="color:blue">fun</span> (a b:<span style="color:blue">Type</span>) (f:st a) (g:a <span style="color:blue">-&gt;</span> st b) (h:heap) <span style="color:blue">-&gt;</span>
             <span style="color:blue">let</span> z, h&#39; = f h <span style="color:blue">in</span> g z h&#39;;
      get = <span style="color:blue">fun</span> () (h:heap) <span style="color:blue">-&gt;</span> h,h;
      put = <span style="color:blue">fun</span> (h:heap) _ <span style="color:blue">-&gt;</span> (),h
}</code></pre></div>
<ul class="ul list-star compact" data-line="608">
<li class="li ul-li list-star-li compact-li fragment" data-line="608"><span data-line="608"></span>this monadic definition is the <span data-line="608"></span><strong class="strong-star2">model</strong><span data-line="608"></span> F<span data-line="608"></span>*<span data-line="608"></span>  uses to verify stateful code
</li>
<li class="li ul-li list-star-li compact-li fragment" data-line="609"><span data-line="609"></span>state can be <span data-line="609"></span><strong class="strong-star2">primitively implemented</strong><span data-line="609"></span> under the hood <span data-line="609"></span><strong class="strong-star2">or not</strong><span data-line="609"></span>

<ul class="ul list-dash compact" data-line="610">
<li class="li ul-li list-dash-li compact-li" data-line="610"><span data-line="610"></span>for instance by ML heap or C stack+heap
</li></ul></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-general-approach-to-stateful-programming-and-other-effects" class="section section2" data-section-depth="2" data-line="615"><h3 id="heading-sec-general-approach-to-stateful-programming-and-other-effects" class="h2" data-heading-depth="2" style="display:block">General approach to stateful programming  (and other effects)</h3>
<ul class="ul list-star loose" data-line="617">
<li class="li ul-li list-star-li loose-li" data-line="617">
<p data-line="617"><span data-line="617"></span>Program libraries to <span data-line="617"></span><strong class="strong-star2">model</strong><span data-line="617"></span> memory, e.g., the ML heap
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="619">
<p data-line="619"><span data-line="619"></span>Derive effectful actions for primitive operations (e.g., <span data-line="619"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">!</code><span data-line="619"></span>, <span data-line="619"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">:=</code><span data-line="619"></span> etc.)
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="621">
<p data-line="621"><span data-line="621"></span>Write effectful programs against these libraries and verify them
with refined computation types
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="624">
<p data-line="624"><span data-line="624"></span>Extract them to programs in ML or C with primtive effects<span data-line="624"></span> <span data-line="624"></span> 
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="626">

<p data-line="627"><span data-line="627"></span>F<span data-line="627"></span>*<span data-line="627"></span>: 
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="628" data-line-first="629" style="display:block"><code data-line="629"><span style="color:blue">let</span> incr (r:ref int) : <span style="color:blue">ST</span> unit (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))
         (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> h0 _ h1 <span style="color:blue">-&gt;</span> modifies !{r} h0 h1 /\ sel h2 r = sel h1 r + <span class="constant" style="color:purple">1</span>))
    = r := !r + <span class="constant" style="color:purple">1</span></code></pre>
<p data-line="633"><span data-line="633"></span>ML:
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="634" data-line-first="635" style="display:block"><code data-line="635"><span style="color:blue">let</span> incr (r:ref int) : unit = r := !r + <span class="constant" style="color:purple">1</span></code></pre>
<p data-line="637"><span data-line="637"></span>C:
</p>
<pre class="para-block pre-fenced pre-fenced3 language-c lang-c c" data-line="638" data-line-first="639" style="display:block"><code data-line="639">void incr (int *r) { *r = *r + 1; }</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-modeling-the-ml-heap" class="section section2" data-section-depth="2" data-line="644"><h3 id="heading-sec-modeling-the-ml-heap" class="h2" data-heading-depth="2" style="display:block">Modeling the ML heap</h3>
<ul class="ul list-star compact" data-line="646">
<li class="li ul-li list-star-li compact-li fragment" data-line="646"><span data-line="646"></span>A sketch of <span data-line="646"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">FStar.Heap</code><span data-line="646"></span>:

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="647" data-line-first="648" style="display:block"><code data-line="648"><span style="color:blue">module</span> Heap
<span style="color:blue">abstract</span> <span style="color:blue">let</span> addr = nat
<span style="color:blue">abstract</span> <span style="color:blue">let</span> heap = {
  next_addr: addr;
  map: addr <span style="color:blue">-&gt;</span> option (a:<span style="color:blue">Type0</span> &amp; v:a &amp; ...) {
     <span style="color:blue">forall</span> a. h &gt; next_addr ==&gt; map a == None
  }
}</code></pre></li></ul>

<ul class="ul list-star compact" data-line="659">
<li class="li ul-li list-star-li compact-li fragment" data-line="659">

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="660" data-line-first="661" style="display:block"><code data-line="661"><span style="color:darkgreen">//A `ref t` is an address that contains a `t` in the current and all future heaps</span>
<span style="color:blue">abstract</span> <span style="color:blue">let</span> ref (t:<span style="color:blue">Type</span>) =
    a:addr{witnessed (<span style="color:blue">fun</span> h <span style="color:blue">-&gt;</span> h.map a = Some (| t, _, _ |))}

<span style="color:blue">abstract</span> <span style="color:blue">let</span> sel (r:ref t) (h:heap) = <span style="color:blue">let</span> Some (|_, v, ... |) = h.map r <span style="color:blue">in</span> v
<span style="color:blue">abstract</span> <span style="color:blue">let</span> upd ...

<span style="color:blue">let</span> modifies (s:set addr) (h0 h1 : heap) =
  <span style="color:blue">forall</span> a. h0 `contains` a /\ ~(a `mem` s) ==&gt; sel h0 a == sel h1 a
</code></pre></li></ul>
<!-------------------------------------------------------------------------------->


</section>
<section id="sec-refined-computation-types-for-state" class="section section2" data-section-depth="2" data-line="675"><h3 id="heading-sec-refined-computation-types-for-state" class="h2" data-heading-depth="2" style="display:block">Refined Computation Types for State</h3>
<ul class="ul list-star loose" data-line="677">
<li class="li ul-li list-star-li loose-li" data-line="677">
<p data-line="677"><span data-line="677"></span>Hoare logic-style <span data-line="677"></span><strong class="strong-star2"><span style="color:DarkGreen">pre-conditions</span></strong><span data-line="677"></span> and <span data-line="677"></span><strong class="strong-star2"><span style="color:DarkRed">post-conditions</span></strong><span data-line="677"></span>
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="678" data-line-first="679" style="display:block"><code data-line="679"><span style="color:blue">ST</span> (result:<span style="color:blue">Type</span>) (pre: heap <span style="color:blue">-&gt;</span> prop) (post: heap <span style="color:blue">-&gt;</span> result <span style="color:blue">-&gt;</span> heap <span style="color:blue">-&gt;</span> prop)</code></pre></li>
<li class="li ul-li list-star-li loose-li" data-line="681">
<p data-line="681"><span data-line="681"></span>stateful <span data-line="681"></span><strong class="strong-star2"><span style="color:DarkGreen">pre-condition</span></strong><span data-line="681"></span> is <span data-line="681"></span><strong class="strong-star2"><span style="color:DarkGreen">predicate on initial states</span></strong><span data-line="681"></span>
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="682">
<p data-line="682"><span data-line="682"></span><strong class="strong-star2"><span style="color:DarkRed">post-condition</span></strong><span data-line="682"></span> is <span data-line="682"></span><strong class="strong-star2"><span style="color:DarkRed">relation on initial states, results, and final states</span></strong><span data-line="682"></span>
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="683">
<p data-line="683"><span data-line="683"></span>the more complex the effect, the more complex the specs (and proofs)
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="685">

<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="686" data-line-first="687" style="display:block"><code data-line="687"><span style="color:blue">val</span> get : unit
     <span style="color:blue">-&gt;</span> <span style="color:blue">ST</span> heap 
  (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> h <span style="color:blue">-&gt;</span> True))
  (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> h0 result h1 <span style="color:blue">-&gt;</span> h0 == result /\ result == h1))
  
<span style="color:blue">val</span> put : h:heap 
     <span style="color:blue">-&gt;</span> <span style="color:blue">ST</span> unit
  (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))
  (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> _ _ h1 <span style="color:blue">-&gt;</span> h1 == h))</code></pre></li></ul>
<!-------------------------------------------------------------------------------->


</section>
<section id="sec-deriving-ml-like-effectful-operations" class="section section2" data-section-depth="2" data-line="700"><h3 id="heading-sec-deriving-ml-like-effectful-operations" class="h2" data-heading-depth="2" style="display:block">Deriving ML-like Effectful Operations</h3>
<ul class="ul list-star loose" data-line="702">
<li class="li ul-li list-star-li loose-li" data-line="702">
<p data-line="702"><span data-line="702"></span>Reading references
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="703" data-line-first="704" style="display:block"><code data-line="704"><span style="color:blue">let</span> (!) #t (r:ref t)
  : <span style="color:blue">ST</span> t
      (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))
      (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> h0 x h1 <span style="color:blue">-&gt;</span> h0 == h1 /\ x = sel h1 r)) =
  <span style="color:blue">let</span> h0 = get () <span style="color:blue">in</span>
  sel h0 r</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="712">
<p data-line="712"><span data-line="712"></span>Writing references
</p>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="713" data-line-first="714" style="display:block"><code data-line="714"><span style="color:blue">let</span> (:=) #t (r:ref t) (v:t)
  : <span style="color:blue">ST</span> unit
      (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> _ <span style="color:blue">-&gt;</span> True))
      (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> h0 x h1 <span style="color:blue">-&gt;</span> h1 = upd h0 r v)) =
  <span style="color:blue">let</span> h0 = get () <span style="color:blue">in</span>
  put (upd h0 r v)</code></pre></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="722">
<p data-line="722"><span data-line="722"></span>Allocating references <span data-line="722"></span>&#8230;<span data-line="722"></span>
</p></li>
<li class="li ul-li list-star-li loose-li fragment" data-line="723">
<p data-line="723"><span data-line="723"></span>Freeing references <span data-line="723"></span>&#8230;<span data-line="723"></span>
</p></li></ul>
<!-------------------------------------------------------------------------------->

</section>
<section id="sec-reference-swapping-hand-proof-sketch" class="section section2" data-section-depth="2" data-line="726"><h3 id="heading-sec-reference-swapping-hand-proof-sketch" class="h2" data-heading-depth="2" style="display:block">Reference swapping (hand proof sketch)</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="727" data-line-first="728;out/fstar-sri\aux/SwapRefsST.fst:17" style="display:block"><code data-line="728;out/fstar-sri\aux/SwapRefsST.fst:17"><span style="color:blue">val</span> swap : r1:ref int <span style="color:blue">-&gt;</span> r2:ref int <span style="color:blue">-&gt;</span> <span style="color:blue">ST</span> unit
    (<span style="color:blue">requires</span> (<span style="color:blue">fun</span> h0 <span style="color:blue">-&gt;</span> True))
    (<span style="color:blue">ensures</span> (<span style="color:blue">fun</span> h0 _ h3 <span style="color:blue">-&gt;</span> modifies !{r1,r2} h0 h3 /\
                             sel h3 r2 == sel h0 r1 /\ sel h3 r1 == sel h0 r2))
<span style="color:blue">let</span> swap r1 r2 =
  <span style="color:blue">let</span> t = !r1 <span style="color:blue">in</span>
    <span style="color:darkgreen">(*</span><span style="color:darkgreen"> Know </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P1): exists h1 t. modifies !{} h0 h1 /\ t == sel h0 r1 </span><span style="color:darkgreen">*)</span>
  r1 := !r2;
    <span style="color:darkgreen">(*</span><span style="color:darkgreen"> Know </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P2): exists h2. modifies !{r1} h1 h2 /\ sel h2 r1 == sel h1 r2 </span><span style="color:darkgreen">*)</span>
  r2 := t
    <span style="color:darkgreen">(*</span><span style="color:darkgreen"> Know </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P3): modifies !{r2} h2 h3 /\ sel h3 r2 == t </span><span style="color:darkgreen">*)</span></code></pre>
<div class="fragment" data-line="731">
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="732" data-line-first="733;out/fstar-sri\aux/SwapRefsST.fst:31" style="display:block"><code data-line="733;out/fstar-sri\aux/SwapRefsST.fst:31"><span style="color:darkgreen">(*</span><span style="color:darkgreen"> `modifies !{r1,r2} h0 h3` follows directly from transitivity of modifies </span><span style="color:darkgreen">*)</span>

<span style="color:darkgreen">(*</span><span style="color:darkgreen"> `sel h3 r2 == sel h0 r1` follows immediately from </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P1) and </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P3) </span><span style="color:darkgreen">*)</span>

<span style="color:darkgreen">(*</span><span style="color:darkgreen"> Still to show: `sel h3 r1 == sel h0 r2`</span>
<span style="color:darkgreen">   From </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P2) we know that  `sel h2 r1 == sel h1 r2` </span><span style="color:darkgreen">(</span><span style="color:darkgreen">A)</span>
<span style="color:darkgreen">   From </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P1) we know that  modifies !{} h0 h1</span>
<span style="color:darkgreen">     which by definition gives us  sel h1 r2 == sel h0 r2 </span><span style="color:darkgreen">(</span><span style="color:darkgreen">B)</span>
<span style="color:darkgreen">   From </span><span style="color:darkgreen">(</span><span style="color:darkgreen">P3) we know that  modifies !{r2} h2 h3</span>
<span style="color:darkgreen">     which by definition gives us  sel h2 r1 == sel h3 r1 </span><span style="color:darkgreen">(</span><span style="color:darkgreen">C)</span>
<span style="color:darkgreen">   We conclude by transitivity from </span><span style="color:darkgreen">(</span><span style="color:darkgreen">A)+</span><span style="color:darkgreen">(</span><span style="color:darkgreen">B)+</span><span style="color:darkgreen">(</span><span style="color:darkgreen">C) </span><span style="color:darkgreen">*)</span></code></pre></div>
<ul class="ul list-star compact" data-line="736">
<li class="li ul-li list-star-li compact-li fragment" data-line="736"><span data-line="736"></span>This variant is correct even when <span data-line="736"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">r1</code><span data-line="736"></span> and <span data-line="736"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">r2</code><span data-line="736"></span> are aliased
</li></ul>
</section>
<section id="fstar2smt" class="section section1" data-section-depth="1" data-line="738"><h2 id="heading-fstar2smt" class="h1" data-heading-depth="1" style="display:block">From F* to SMT</h2><!------------------------------------------------------------------------------>


</section>
<section id="smtencoding" class="section section2" data-section-depth="2" data-line="742"><h3 id="heading-smtencoding" class="h2" data-heading-depth="2" style="display:block">SMT encoding</h3>
<ul class="ul list-dash loose" data-line="744">
<li class="li ul-li list-dash-li loose-li" data-line="744">
<p data-line="744"><span data-line="744"></span>F<span data-line="744"></span>*<span data-line="744"></span> verification conditions
</p>
<ul class="ul list-plus compact" data-line="745">
<li class="li ul-li list-plus-li compact-li" data-line="745"><span data-line="745"></span><strong class="strong-star2">classical, dependently typed, higher-order logic</strong><span data-line="745"></span>
</li></ul>
</li>
<li class="li ul-li list-dash-li loose-li fragment" data-line="747">
<p data-line="747"><span data-line="747"></span>We encode this to SMT
</p>
<ul class="ul list-plus compact" data-line="748">
<li class="li ul-li list-plus-li compact-li" data-line="748"><span data-line="748"></span><strong class="strong-star2">FOL + equality and function symbols + arithmetic + e-matching </strong><span data-line="748"></span>
</li>
<li class="li ul-li list-plus-li compact-li" data-line="749"><span data-line="749"></span>goals: <span data-line="749"></span><strong class="strong-star2">soundness</strong><span data-line="749"></span>, <span data-line="749"></span><strong class="strong-star2">predictability</strong><span data-line="749"></span>, <span data-line="749"></span><strong class="strong-star2">efficiency</strong><span data-line="749"></span>, <span data-line="749"></span><strong class="strong-star2">scalability</strong><span data-line="749"></span>
</li>
<li class="li ul-li list-plus-li compact-li" data-line="750"><span data-line="750"></span>pragmatic balance between <span data-line="750"></span><strong class="strong-star2">completeness</strong><span data-line="750"></span> and <span data-line="750"></span><strong class="strong-star2">practical tractability</strong><span data-line="750"></span>
</li></ul>
</li>
<li class="li ul-li list-dash-li loose-li fragment" data-line="752">
<p data-line="752"><span data-line="752"></span>The encoding
</p>
<ul class="ul list-plus compact" data-line="753">
<li class="li ul-li list-plus-li compact-li" data-line="753"><span data-line="753"></span><strong class="strong-star2">preserves types</strong><span data-line="753"></span>
</li>
<li class="li ul-li list-plus-li compact-li" data-line="754"><span data-line="754"></span>combines a <span data-line="754"></span><strong class="strong-star2">deep and a shallow embedding</strong><span data-line="754"></span> of F<span data-line="754"></span>*<span data-line="754"></span> terms
</li>
<li class="li ul-li list-plus-li compact-li" data-line="755"><span data-line="755"></span>allows <span data-line="755"></span><strong class="strong-star2">bounded unrolling</strong><span data-line="755"></span> of recursive and inductive definitions
</li>
<li class="li ul-li list-plus-li compact-li" data-line="756"><span data-line="756"></span>eliminates first-class functions by <span data-line="756"></span><strong class="strong-star2">lambda lifting</strong><span data-line="756"></span>
</li>
<li class="li ul-li list-plus-li compact-li" data-line="757"><span data-line="757"></span>uses <span data-line="757"></span><strong class="strong-star2">SMT-patterns</strong><span data-line="757"></span> extensively to guide instantiation of quantifiers
</li>
<li class="li ul-li list-plus-li compact-li" data-line="758"><span data-line="758"></span>currently targets only Z3 (but some early experiments with CVC4)
</li></ul>
</li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-encoding-primitive-operations-and-types" class="section section2" data-section-depth="2" data-line="762"><h3 id="heading-sec-encoding-primitive-operations-and-types" class="h2" data-heading-depth="2" style="display:block">Encoding primitive operations and types</h3>
<ul class="ul list-star loose" data-line="764">
<li class="li ul-li list-star-li loose-li" data-line="764">
<p data-line="764"><span data-line="764"></span><span style="color:Black;">Primitive types</span><span data-line="764"></span> (booleans, integers<span data-line="764"></span>&#8230;<span data-line="764"></span>) are boxed
</p>
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="766" data-line-first="767" style="display:block"><code data-line="767">(<span style="color:blue">declare-sort</span> <span style="color:teal">Term</span>)

(<span style="color:blue">declare-fun</span> <span style="color:teal">BoxInt</span> (<span style="color:teal">Int</span>) <span style="color:teal">Term</span>)
(<span style="color:blue">declare-fun</span> <span style="color:teal">BoxInt_proj</span> (<span style="color:teal">Term</span>) <span style="color:teal">Int</span>)
(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Int</span>)) (= (<span style="color:teal">BoxInt_proj</span> (<span style="color:teal">BoxInt</span> @x)) @x))) 

(<span style="color:blue">declare-fun</span> <span style="color:teal">Prims.int</span> () <span style="color:teal">Type</span>)
(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Int</span>)) (<span style="color:teal">HasType</span> (<span style="color:teal">BoxInt</span> @x) <span style="color:teal">Prims.int</span>))))</code></pre>
<p data-line="777"><span data-line="777"></span>Operators are given shallow semantics: 
</p>
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="778" data-line-first="779" style="display:block"><code data-line="779"> (<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Term</span>) (@y <span style="color:teal">Term</span>))
   (= (op_Subtraction @x @y) (<span style="color:teal">BoxInt</span> (- (<span style="color:teal">BoxInt_proj</span> @x) (<span style="color:teal">BoxInt_proj</span> @y))))))</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-typechecking-factorial" class="section section2" data-section-depth="2" data-line="785"><h3 id="heading-sec-typechecking-factorial" class="h2" data-heading-depth="2" style="display:block">Typechecking factorial</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="786" data-line-first="787" style="display:block"><code data-line="787"><span style="color:blue">type</span> nat = x:int{x&gt;=<span class="constant" style="color:purple">0</span>}
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial (n:nat) : nat = <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>))</code></pre>
<ul class="ul list-star compact" data-line="790">
<li class="li ul-li list-star-li compact-li fragment" data-line="790"><span data-line="790"></span>Encoding type <span data-line="790"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">nat</code><span data-line="790"></span>:

<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="791" data-line-first="792" style="display:block"><code data-line="792">(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Term</span>))
(iff (<span style="color:teal">HasType</span> @x nat) (and (<span style="color:teal">HasType</span> @x int) (&gt;= (<span style="color:teal">BoxInt_proj</span> @x) <span class="constant" style="color:purple">0</span>)))))</code></pre></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="795"><span data-line="795"></span>Proving termination:

<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="796" data-line-first="797" style="display:block"><code data-line="797">(<span style="color:blue">declare-fun</span> n () <span style="color:teal">Term</span>)
(<span style="color:blue">assert</span> (not (implies (and (<span style="color:teal">HasType</span> n nat) (not (= n (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">0</span>))))
                      (<span style="color:teal">Valid</span> (<span style="color:teal">Precedes</span> (op_Subtraction n (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">1</span>)) n)))))</code></pre></li>
<li class="li ul-li list-star-li compact-li fragment" data-line="801"><span data-line="801"></span>Can be proved because of this axiom:

<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="802" data-line-first="803" style="display:block"><code data-line="803">(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Term</span>) (@y <span style="color:teal">Term</span>))
         (implies (and (<span style="color:teal">HasType</span> @x nat) (<span style="color:teal">HasType</span> @y nat)
                       (&lt; (<span style="color:teal">BoxInt_proj</span> @x) (<span style="color:teal">BoxInt_proj</span> @y)))
                  (<span style="color:teal">Valid</span> (<span style="color:teal">Precedes</span> @x @y)))))</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-typechecking-factorial-2" class="section section2" data-section-depth="2" data-line="811"><h3 id="heading-sec-typechecking-factorial-2" class="h2" data-heading-depth="2" style="display:block">Typechecking factorial (2)</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="812" data-line-first="813" style="display:block"><code data-line="813"><span style="color:blue">type</span> nat = x:int{x&gt;=<span class="constant" style="color:purple">0</span>}
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial (n:nat) : nat = <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>))</code></pre>
<ul class="ul list-star compact" data-line="816">
<li class="li ul-li list-star-li compact-li fragment" data-line="816"><span data-line="816"></span>Return value is <span data-line="816"></span><code class="code code1 language-fstarlang lang-fstarlang fstarlang colorized">nat</code><span data-line="816"></span>

<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="817" data-line-first="818" style="display:block"><code data-line="818">(<span style="color:blue">declare-fun</span> n () <span style="color:teal">Term</span>)
(<span style="color:blue">assert</span> (<span style="color:teal">HasType</span> n nat))
(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Term</span>))
              (implies (and (<span style="color:teal">HasType</span> @x nat) (<span style="color:teal">Valid</span> (<span style="color:teal">Precedes</span> @x n)))
                       (<span style="color:teal">HasType</span> (factorial @x) nat))))</code></pre>
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="824" data-line-first="825" style="display:block"><code data-line="825">(<span style="color:blue">assert</span> (not (ite (<span style="color:teal">BoxBool_proj</span> (op_Equality int n (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">0</span>)))
                (&gt;= <span class="constant" style="color:purple">1</span> <span class="constant" style="color:purple">0</span>)
                (&gt;= (<span style="color:teal">BoxInt_proj</span> (op_Multiply n
                      (factorial (op_Subtraction n (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">1</span>))))) <span class="constant" style="color:purple">0</span> ))))</code></pre></li></ul>
<!------------------------------------------------------------------------------>


</section>
<section id="sec-allowing-smt-solver-to-do-bounded-unrolling" class="section section2" data-section-depth="2" data-line="833"><h3 id="heading-sec-allowing-smt-solver-to-do-bounded-unrolling" class="h2" data-heading-depth="2" style="display:block">Allowing SMT solver to do bounded unrolling</h3>
<pre class="para-block pre-fenced pre-fenced3 language-fstarlang lang-fstarlang fstarlang colorized" data-line="834" data-line-first="835" style="display:block"><code data-line="835"><span style="color:blue">type</span> nat = x:int{x&gt;=<span class="constant" style="color:purple">0</span>}
<span style="color:blue">let</span> <span style="color:blue">rec</span> factorial (n:nat) : nat = <span style="color:blue">if</span> n = <span class="constant" style="color:purple">0</span> <span style="color:blue">then</span> <span class="constant" style="color:purple">1</span> <span style="color:blue">else</span> n * (factorial (n - <span class="constant" style="color:purple">1</span>))</code></pre>
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="838" data-line-first="839" style="display:block"><code data-line="839">(<span style="color:blue">declare-datatypes</span> () ((<span style="color:teal">Fuel</span> (<span style="color:teal">ZFuel</span>) (<span style="color:teal">SFuel</span> (prec <span style="color:teal">Fuel</span>)))))
(<span style="color:blue">declare-fun</span> <span style="color:teal">MaxFuel</span> () <span style="color:teal">Fuel</span>)
(<span style="color:blue">assert</span> (= <span style="color:teal">MaxFuel</span> (<span style="color:teal">SFuel</span> (<span style="color:teal">SFuel</span> <span style="color:teal">ZFuel</span>))))</code></pre>
<div class="fragment" data-line="843">
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="844" data-line-first="845" style="display:block"><code data-line="845">(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@f <span style="color:teal">Fuel</span>) (x <span style="color:teal">Term</span>))
        (implies (<span style="color:teal">HasType</span> x nat)
                 (= (factorial_fuel (<span style="color:teal">SFuel</span> @f) x)
                    (ite (op_Equality int x (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">0</span>))
                         (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">1</span>)
                         (op_Multiply x
                                (factorial_fuel @f
                                     (op_Subtraction x (<span style="color:teal">BoxInt</span> <span class="constant" style="color:purple">1</span>)))))))))</code></pre></div>
<div class="fragment" data-line="855">
<pre class="para-block pre-fenced pre-fenced3 language-smt lang-smt smt colorized" data-line="856" data-line-first="857" style="display:block"><code data-line="857">(<span style="color:blue">assert</span> (<span style="color:blue">forall</span> ((@x <span style="color:teal">Term</span>)) (= (factorial @x) (factorial_fuel <span style="color:teal">MaxFuel</span> @x))))</code></pre></div><!------------------------------------------------------------------------------>


</section>
<section id="sec-summary" class="section section1" data-section-depth="1" data-line="863"><h2 id="heading-sec-summary" class="h1" data-heading-depth="1" style="display:block">Summary</h2>
<ul class="ul list-star loose" data-line="865">
<li class="li ul-li list-star-li loose-li" data-line="865">
<p data-line="865"><span data-line="865"></span>A core dependently typed logic of pure total functions
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="867">
<p data-line="867"><span data-line="867"></span>Extensible with effects, including divergence and user-defined
effects like state, exceptions, non-determinism, <span data-line="868"></span>&#8230;<span data-line="868"></span>
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="870">
<p data-line="870"><span data-line="870"></span>Primitive handling of some effects to extract to efficient code in
ML or C
</p></li>
<li class="li ul-li list-star-li loose-li" data-line="873">
<p data-line="873"><span data-line="873"></span>Aims to bridge the gap between verifiers for effectful programming
languages and dependently typed proof assistants
</p>
<ul class="ul list-dash compact" data-line="876">
<li class="li ul-li list-dash-li compact-li" data-line="876"><span data-line="876"></span>Relying on a verification condition generator
</li>
<li class="li ul-li list-dash-li compact-li" data-line="877"><span data-line="877"></span>And an encoding of F<span data-line="877"></span>*<span data-line="877"></span>&#39;<span data-line="877"></span>s logic to SMT for proof automation
</li></ul>
</li></ul></section></div></div><span data-line=""></span></div>
<svg id='math-svg-paths' style='display:none' version='1.1' viewBox='0 0 0 0' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
<defs>
<path d='M9.056 -1.325C9.225 -1.325 9.405 -1.325 9.405 -1.524S9.225 -1.724 9.046 -1.724H2.72C2.301 -2.082 1.793 -2.341 1.465 -2.491C1.823 -2.65 2.311 -2.909 2.72 -3.258H9.046C9.225 -3.258 9.405 -3.258 9.405 -3.457S9.225 -3.656 9.056 -3.656H3.168C3.646 -4.115 4.164 -4.991 4.164 -5.121C4.164 -5.23 4.035 -5.23 3.975 -5.23C3.895 -5.23 3.826 -5.23 3.786 -5.151C3.577 -4.772 3.298 -4.244 2.65 -3.666C1.963 -3.059 1.295 -2.79 0.777 -2.64C0.608 -2.58 0.598 -2.57 0.578 -2.55C0.558 -2.54 0.558 -2.511 0.558 -2.491S0.558 -2.451 0.568 -2.431L0.598 -2.411C0.618 -2.401 0.628 -2.391 0.817 -2.331C2.162 -1.933 3.158 -1.026 3.716 0.04C3.826 0.239 3.836 0.249 3.975 0.249C4.035 0.249 4.164 0.249 4.164 0.139C4.164 0.01 3.656 -0.857 3.168 -1.325H9.056Z' id='g1-40'/>
<path d='M5.181 -3.258C5.35 -3.258 5.529 -3.258 5.529 -3.457S5.35 -3.656 5.181 -3.656H0.946V-6.555C0.946 -6.735 0.946 -6.914 0.747 -6.914S0.548 -6.705 0.548 -6.555V-0.359C0.548 -0.209 0.548 0 0.747 0S0.946 -0.179 0.946 -0.359V-3.258H5.181Z' id='g1-96'/>
<path d='M4.354 -6.675C4.354 -6.695 4.384 -6.804 4.384 -6.814S4.384 -6.914 4.264 -6.914C4.164 -6.914 4.154 -6.884 4.115 -6.715L3.537 -4.413C1.953 -4.364 0.488 -3.039 0.488 -1.684C0.488 -0.737 1.186 0.05 2.401 0.12C2.321 0.428 2.252 0.747 2.172 1.056C2.052 1.524 1.953 1.903 1.953 1.933C1.953 2.032 2.022 2.042 2.072 2.042S2.142 2.032 2.172 2.002C2.192 1.983 2.252 1.743 2.281 1.604L2.66 0.12C4.264 0.07 5.709 -1.275 5.709 -2.61C5.709 -3.397 5.181 -4.314 3.796 -4.413L4.354 -6.675ZM2.451 -0.1C1.853 -0.13 1.136 -0.478 1.136 -1.474C1.136 -2.67 1.993 -4.065 3.477 -4.194L2.451 -0.1ZM3.736 -4.194C4.493 -4.154 5.061 -3.696 5.061 -2.819C5.061 -1.644 4.204 -0.219 2.71 -0.1L3.736 -4.194Z' id='g2-30'/>
<path d='M2.052 -3.985H2.989C3.188 -3.985 3.288 -3.985 3.288 -4.184C3.288 -4.294 3.188 -4.294 3.009 -4.294H2.132C2.491 -5.709 2.54 -5.908 2.54 -5.968C2.54 -6.137 2.421 -6.237 2.252 -6.237C2.222 -6.237 1.943 -6.227 1.853 -5.878L1.465 -4.294H0.528C0.329 -4.294 0.229 -4.294 0.229 -4.105C0.229 -3.985 0.309 -3.985 0.508 -3.985H1.385C0.667 -1.156 0.628 -0.986 0.628 -0.807C0.628 -0.269 1.006 0.11 1.544 0.11C2.56 0.11 3.128 -1.345 3.128 -1.425C3.128 -1.524 3.049 -1.524 3.009 -1.524C2.919 -1.524 2.909 -1.494 2.859 -1.385C2.431 -0.349 1.903 -0.11 1.564 -0.11C1.355 -0.11 1.255 -0.239 1.255 -0.568C1.255 -0.807 1.275 -0.877 1.315 -1.046L2.052 -3.985Z' id='g2-116'/>
<path d='M5.519 -6.775H0.329V-6.466H0.568C1.335 -6.466 1.355 -6.356 1.355 -5.998V-0.777C1.355 -0.418 1.335 -0.309 0.568 -0.309H0.329V0C0.677 -0.03 1.455 -0.03 1.843 -0.03C2.252 -0.03 3.158 -0.03 3.517 0V-0.309H3.188C2.242 -0.309 2.242 -0.438 2.242 -0.787V-6.067C2.242 -6.396 2.262 -6.466 2.73 -6.466H3.756C5.181 -6.466 5.39 -5.878 5.549 -4.533H5.798L5.519 -6.775Z' id='g3-0'/>
<path d='M1.913 -3.766C1.913 -4.055 1.674 -4.294 1.385 -4.294S0.857 -4.055 0.857 -3.766S1.096 -3.238 1.385 -3.238S1.913 -3.477 1.913 -3.766ZM1.913 -0.528C1.913 -0.817 1.674 -1.056 1.385 -1.056S0.857 -0.817 0.857 -0.528S1.096 0 1.385 0S1.913 -0.239 1.913 -0.528Z' id='g3-58'/>
<path d='M3.786 -0.548V0.11L5.25 0V-0.309C4.553 -0.309 4.473 -0.379 4.473 -0.867V-6.914L3.039 -6.804V-6.496C3.736 -6.496 3.816 -6.426 3.816 -5.938V-3.786C3.527 -4.144 3.098 -4.403 2.56 -4.403C1.385 -4.403 0.339 -3.427 0.339 -2.142C0.339 -0.877 1.315 0.11 2.451 0.11C3.088 0.11 3.537 -0.229 3.786 -0.548ZM3.786 -3.218V-1.176C3.786 -0.996 3.786 -0.976 3.676 -0.807C3.377 -0.329 2.929 -0.11 2.501 -0.11C2.052 -0.11 1.694 -0.369 1.455 -0.747C1.196 -1.156 1.166 -1.724 1.166 -2.132C1.166 -2.501 1.186 -3.098 1.474 -3.547C1.684 -3.856 2.062 -4.184 2.6 -4.184C2.949 -4.184 3.367 -4.035 3.676 -3.587C3.786 -3.417 3.786 -3.397 3.786 -3.218Z' id='g3-100'/>
<path d='M1.116 -2.511C1.176 -3.995 2.012 -4.244 2.351 -4.244C3.377 -4.244 3.477 -2.899 3.477 -2.511H1.116ZM1.106 -2.301H3.885C4.105 -2.301 4.134 -2.301 4.134 -2.511C4.134 -3.497 3.597 -4.463 2.351 -4.463C1.196 -4.463 0.279 -3.437 0.279 -2.192C0.279 -0.857 1.325 0.11 2.471 0.11C3.686 0.11 4.134 -0.996 4.134 -1.186C4.134 -1.285 4.055 -1.305 4.005 -1.305C3.915 -1.305 3.895 -1.245 3.875 -1.166C3.527 -0.139 2.63 -0.139 2.531 -0.139C2.032 -0.139 1.634 -0.438 1.405 -0.807C1.106 -1.285 1.106 -1.943 1.106 -2.301Z' id='g3-101'/>
<path d='M1.763 -6.914L0.329 -6.804V-6.496C1.026 -6.496 1.106 -6.426 1.106 -5.938V-0.757C1.106 -0.309 0.996 -0.309 0.329 -0.309V0C0.658 -0.01 1.186 -0.03 1.435 -0.03S2.172 -0.01 2.54 0V-0.309C1.873 -0.309 1.763 -0.309 1.763 -0.757V-6.914Z' id='g3-108'/>
<path d='M1.714 -3.746V-4.403L0.279 -4.294V-3.985C0.986 -3.985 1.056 -3.925 1.056 -3.487V1.176C1.056 1.624 0.946 1.624 0.279 1.624V1.933C0.618 1.923 1.136 1.903 1.395 1.903C1.664 1.903 2.172 1.923 2.521 1.933V1.624C1.853 1.624 1.743 1.624 1.743 1.176V-0.498V-0.588C1.793 -0.428 2.212 0.11 2.969 0.11C4.154 0.11 5.191 -0.867 5.191 -2.152C5.191 -3.417 4.224 -4.403 3.108 -4.403C2.331 -4.403 1.913 -3.965 1.714 -3.746ZM1.743 -1.136V-3.357C2.032 -3.866 2.521 -4.154 3.029 -4.154C3.756 -4.154 4.364 -3.278 4.364 -2.152C4.364 -0.946 3.666 -0.11 2.929 -0.11C2.531 -0.11 2.152 -0.309 1.883 -0.717C1.743 -0.927 1.743 -0.936 1.743 -1.136Z' id='g3-112'/>
<path d='M1.664 -3.308V-4.403L0.279 -4.294V-3.985C0.976 -3.985 1.056 -3.915 1.056 -3.427V-0.757C1.056 -0.309 0.946 -0.309 0.279 -0.309V0C0.667 -0.01 1.136 -0.03 1.415 -0.03C1.813 -0.03 2.281 -0.03 2.68 0V-0.309H2.471C1.733 -0.309 1.714 -0.418 1.714 -0.777V-2.311C1.714 -3.298 2.132 -4.184 2.889 -4.184C2.959 -4.184 2.979 -4.184 2.999 -4.174C2.969 -4.164 2.77 -4.045 2.77 -3.786C2.77 -3.507 2.979 -3.357 3.198 -3.357C3.377 -3.357 3.626 -3.477 3.626 -3.796S3.318 -4.403 2.889 -4.403C2.162 -4.403 1.803 -3.736 1.664 -3.308Z' id='g3-114'/>
<path d='M3.895 -0.787V0.11L5.33 0V-0.309C4.633 -0.309 4.553 -0.379 4.553 -0.867V-4.403L3.088 -4.294V-3.985C3.786 -3.985 3.866 -3.915 3.866 -3.427V-1.654C3.866 -0.787 3.387 -0.11 2.66 -0.11C1.823 -0.11 1.783 -0.578 1.783 -1.096V-4.403L0.319 -4.294V-3.985C1.096 -3.985 1.096 -3.955 1.096 -3.068V-1.574C1.096 -0.797 1.096 0.11 2.61 0.11C3.168 0.11 3.606 -0.169 3.895 -0.787Z' id='g3-117'/>
<path d='M4.394 -3.457C4.513 -3.457 4.842 -3.457 4.842 -3.806S4.473 -4.154 4.334 -4.154H0.887C0.747 -4.154 0.379 -4.154 0.379 -3.806S0.707 -3.457 0.827 -3.457H4.394ZM4.334 -1.943C4.473 -1.943 4.842 -1.943 4.842 -2.291S4.513 -2.64 4.394 -2.64H0.827C0.707 -2.64 0.379 -2.64 0.379 -2.291S0.747 -1.943 0.887 -1.943H4.334Z' id='g0-61'/>
<path d='M3.646 -0.319C3.866 -0.01 4.344 0 4.722 0C5.001 0 5.22 0 5.22 -0.309C5.22 -0.608 4.971 -0.608 4.822 -0.608C4.403 -0.608 4.304 -0.658 4.224 -0.687V-2.839C4.224 -3.547 3.686 -4.384 2.252 -4.384C1.823 -4.384 0.807 -4.384 0.807 -3.656C0.807 -3.357 1.016 -3.198 1.255 -3.198C1.405 -3.198 1.684 -3.288 1.694 -3.656C1.694 -3.736 1.704 -3.746 1.903 -3.766C2.042 -3.776 2.172 -3.776 2.262 -3.776C3.019 -3.776 3.537 -3.467 3.537 -2.76C1.773 -2.73 0.548 -2.232 0.548 -1.275C0.548 -0.588 1.176 0.06 2.192 0.06C2.56 0.06 3.178 -0.01 3.646 -0.319ZM3.537 -2.172V-1.335C3.537 -1.106 3.537 -0.897 3.148 -0.717C2.79 -0.548 2.341 -0.548 2.262 -0.548C1.644 -0.548 1.235 -0.887 1.235 -1.275C1.235 -1.763 2.092 -2.132 3.537 -2.172Z' id='g0-97'/>
<path d='M4.643 -1.086C4.643 -1.365 4.354 -1.365 4.294 -1.365C4.134 -1.365 4.035 -1.345 3.965 -1.146C3.905 -1.016 3.716 -0.548 2.979 -0.548C2.132 -0.548 1.415 -1.245 1.415 -2.152C1.415 -2.63 1.694 -3.776 3.039 -3.776C3.248 -3.776 3.636 -3.776 3.636 -3.686C3.646 -3.337 3.836 -3.198 4.075 -3.198S4.523 -3.367 4.523 -3.656C4.523 -4.384 3.487 -4.384 3.039 -4.384C1.325 -4.384 0.727 -3.029 0.727 -2.152C0.727 -0.956 1.664 0.06 2.919 0.06C4.304 0.06 4.643 -0.917 4.643 -1.086Z' id='g0-99'/>
<path d='M4.224 -1.903C4.433 -1.903 4.623 -1.903 4.623 -2.271C4.623 -3.407 3.985 -4.384 2.69 -4.384C1.504 -4.384 0.548 -3.387 0.548 -2.162C0.548 -0.946 1.554 0.06 2.839 0.06C4.154 0.06 4.623 -0.837 4.623 -1.086C4.623 -1.365 4.334 -1.365 4.274 -1.365C4.095 -1.365 4.015 -1.335 3.945 -1.146C3.726 -0.638 3.188 -0.548 2.909 -0.548C2.162 -0.548 1.415 -1.046 1.255 -1.903H4.224ZM1.265 -2.501C1.405 -3.228 1.993 -3.776 2.69 -3.776C3.208 -3.776 3.826 -3.527 3.915 -2.501H1.265Z' id='g0-101'/>
<path d='M2.521 -3.686H3.736C3.885 -3.686 4.134 -3.686 4.134 -3.985C4.134 -4.294 3.895 -4.294 3.736 -4.294H2.521V-4.762C2.521 -5.539 3.188 -5.539 3.487 -5.539C3.487 -5.499 3.577 -5.111 3.925 -5.111C4.125 -5.111 4.354 -5.27 4.354 -5.549C4.354 -6.147 3.557 -6.147 3.397 -6.147C2.6 -6.147 1.833 -5.689 1.833 -4.822V-4.294H0.837C0.677 -4.294 0.428 -4.294 0.428 -3.985C0.428 -3.686 0.677 -3.686 0.827 -3.686H1.833V-0.608H0.827C0.677 -0.608 0.418 -0.608 0.418 -0.309C0.418 0 0.677 0 0.827 0H3.527C3.676 0 3.935 0 3.935 -0.299C3.935 -0.608 3.676 -0.608 3.527 -0.608H2.521V-3.686Z' id='g0-102'/>
<path d='M3.078 -3.885C3.078 -4.194 3.019 -4.294 2.68 -4.294H1.265C1.116 -4.294 0.857 -4.294 0.857 -3.995C0.857 -3.686 1.116 -3.686 1.265 -3.686H2.391V-0.608H1.186C1.026 -0.608 0.777 -0.608 0.777 -0.299C0.777 0 1.036 0 1.186 0H4.125C4.274 0 4.533 0 4.533 -0.299C4.533 -0.608 4.274 -0.608 4.125 -0.608H3.078V-3.885ZM3.078 -5.599C3.078 -5.878 2.859 -6.097 2.58 -6.097S2.082 -5.878 2.082 -5.599S2.301 -5.101 2.58 -5.101S3.078 -5.32 3.078 -5.599Z' id='g0-105'/>
<path d='M2.959 -5.679C2.959 -5.988 2.899 -6.087 2.56 -6.087H0.986C0.827 -6.087 0.578 -6.087 0.578 -5.778C0.578 -5.479 0.837 -5.479 0.976 -5.479H2.271V-0.608H0.986C0.827 -0.608 0.578 -0.608 0.578 -0.299C0.578 0 0.837 0 0.976 0H4.254C4.403 0 4.653 0 4.653 -0.299C4.653 -0.608 4.413 -0.608 4.254 -0.608H2.959V-5.679Z' id='g0-108'/>
<path d='M1.654 -3.826C1.654 -4.144 1.654 -4.294 1.255 -4.294H0.528C0.369 -4.294 0.12 -4.294 0.12 -3.985C0.12 -3.686 0.379 -3.686 0.518 -3.686H0.966V-0.608H0.528C0.369 -0.608 0.12 -0.608 0.12 -0.299C0.12 0 0.379 0 0.518 0H2.102C2.242 0 2.501 0 2.501 -0.299C2.501 -0.608 2.252 -0.608 2.092 -0.608H1.654V-2.371C1.654 -3.367 2.391 -3.746 2.899 -3.746C3.427 -3.746 3.567 -3.467 3.567 -2.869V-0.608H3.178C3.019 -0.608 2.77 -0.608 2.77 -0.299C2.77 0 3.039 0 3.178 0H4.702C4.842 0 5.101 0 5.101 -0.299C5.101 -0.608 4.852 -0.608 4.692 -0.608H4.254V-2.919C4.254 -3.925 3.746 -4.354 2.959 -4.354C2.291 -4.354 1.843 -4.015 1.654 -3.826Z' id='g0-110'/>
<path d='M4.653 -2.152C4.653 -3.397 3.726 -4.384 2.61 -4.384S0.568 -3.397 0.568 -2.152C0.568 -0.887 1.514 0.06 2.61 0.06S4.653 -0.897 4.653 -2.152ZM2.61 -0.548C1.873 -0.548 1.255 -1.295 1.255 -2.222C1.255 -3.128 1.903 -3.776 2.61 -3.776C3.328 -3.776 3.965 -3.128 3.965 -2.222C3.965 -1.295 3.347 -0.548 2.61 -0.548Z' id='g0-111'/>
<path d='M2.212 -1.853C2.212 -2.79 2.8 -3.746 4.005 -3.746C4.015 -3.507 4.184 -3.308 4.433 -3.308C4.653 -3.308 4.852 -3.467 4.852 -3.736C4.852 -3.935 4.732 -4.354 3.905 -4.354C3.397 -4.354 2.76 -4.174 2.212 -3.547V-3.885C2.212 -4.194 2.152 -4.294 1.813 -4.294H0.717C0.568 -4.294 0.319 -4.294 0.319 -3.995C0.319 -3.686 0.558 -3.686 0.717 -3.686H1.524V-0.608H0.717C0.568 -0.608 0.319 -0.608 0.319 -0.309C0.319 0 0.558 0 0.717 0H3.318C3.467 0 3.726 0 3.726 -0.299C3.726 -0.608 3.467 -0.608 3.318 -0.608H2.212V-1.853Z' id='g0-114'/>
<path d='M2.212 -3.686H3.846C3.995 -3.686 4.244 -3.686 4.244 -3.985C4.244 -4.294 4.005 -4.294 3.846 -4.294H2.212V-5.111C2.212 -5.3 2.212 -5.519 1.873 -5.519C1.524 -5.519 1.524 -5.31 1.524 -5.111V-4.294H0.658C0.498 -4.294 0.249 -4.294 0.249 -3.985C0.249 -3.686 0.498 -3.686 0.648 -3.686H1.524V-1.255C1.524 -0.299 2.202 0.06 2.929 0.06C3.666 0.06 4.473 -0.369 4.473 -1.255C4.473 -1.435 4.473 -1.644 4.125 -1.644C3.796 -1.644 3.786 -1.435 3.786 -1.265C3.776 -0.648 3.208 -0.548 2.979 -0.548C2.212 -0.548 2.212 -1.066 2.212 -1.315V-3.686Z' id='g0-116'/>
<path d='M6.107 -5.998C6.107 -6.356 6.127 -6.466 6.894 -6.466H7.133V-6.775H0.329V-6.466H0.568C1.335 -6.466 1.355 -6.356 1.355 -5.998V-0.777C1.355 -0.418 1.335 -0.309 0.568 -0.309H0.329V0C0.677 -0.03 1.415 -0.03 1.793 -0.03S2.919 -0.03 3.268 0V-0.309H3.029C2.262 -0.309 2.242 -0.418 2.242 -0.777V-6.466H5.22V-0.777C5.22 -0.418 5.2 -0.309 4.433 -0.309H4.194V0C4.543 -0.03 5.28 -0.03 5.659 -0.03S6.785 -0.03 7.133 0V-0.309H6.894C6.127 -0.309 6.107 -0.418 6.107 -0.777V-5.998Z' id='g1-5'/>
<path d='M3.557 -2.909C3.965 -1.863 4.443 -0.339 4.603 -0.11C4.762 0.11 4.862 0.11 5.131 0.11H5.35C5.45 0.1 5.46 0.04 5.46 0.01S5.44 -0.04 5.41 -0.08C5.31 -0.189 5.25 -0.339 5.181 -0.538L3.148 -6.207C2.939 -6.785 2.401 -6.914 1.933 -6.914C1.883 -6.914 1.753 -6.914 1.753 -6.804C1.753 -6.725 1.833 -6.705 1.843 -6.705C2.172 -6.645 2.242 -6.585 2.491 -5.908L3.457 -3.198L0.707 -0.468C0.588 -0.349 0.528 -0.289 0.528 -0.159C0.528 0.01 0.667 0.13 0.827 0.13S1.076 0.02 1.156 -0.08L3.557 -2.909Z' id='g0-21'/>
</defs>
</svg>

</body>
<script>
    // initialize printing
    revealConfig.initPrint();
    // initialize background embedded images
    revealConfig.getEmbeddedImages();
    </script>
</html>
